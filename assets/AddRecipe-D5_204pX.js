import{t as U,v as J,w as _,x as M,y as O,r as y,j as e,z as C,I as H,A as T,D as k,B as P,L as K,E as V,F as X,G as Y,H as Z,J as ee,K as te,l as ne,M as se}from"./index-DCwwgQCN.js";import{B as ae}from"./BreadCrumbs-CxHmDTnC.js";import{S as ie}from"./SectionTitle-B1F3kDEH.js";const re=U().shape({thumb:J().required("Image is required"),title:_().required("Title is required"),description:_().max(200,"Description must be at most 200 characters").required("Description is required"),category:_().required("Category is required"),area:_().required("Area is required"),time:M().positive().integer().required("Cooking time is required"),selectedIngredients:O().min(1,"At least one ingredient must be added").of(U().shape({id:_().required("Ingredient ID is required"),measure:_().required("Quantity is required")})),instructions:_().max(200,"Instructions must be at most 200 characters").required("Instructions are required")}),ce="_container_1fzjn_1",oe="_titleWrapper_1fzjn_17",le="_formWrapper_1fzjn_25",de="_form_1fzjn_25",pe="_nameInput_1fzjn_69",me="_textareaWrapper_1fzjn_121",ue="_textarea_1fzjn_121",he="_labelPrep_1fzjn_157",_e="_symbolCounter_1fzjn_177",xe="_recipeData_1fzjn_191",ge="_recipeIncstructions_1fzjn_203",je="_buttonWrapper_1fzjn_211",ye="_button_1fzjn_211",be="_trashBtn_1fzjn_243",fe="_iconTrash_1fzjn_259",Ie="_categoryAndTime_1fzjn_323",s={container:ce,titleWrapper:oe,formWrapper:le,form:de,nameInput:pe,textareaWrapper:me,textarea:ue,labelPrep:he,symbolCounter:_e,recipeData:xe,recipeIncstructions:ge,buttonWrapper:je,button:ye,trashBtn:be,iconTrash:fe,categoryAndTime:Ie},ve="_wrapper_66tml_9",Ne="_uploadBox_66tml_27",We="_uploadAnotherSpan_66tml_51",ze="_customUploadBtn_66tml_73",Ce="_imagePreview_66tml_97",Te="_btnWrapper_66tml_117",Ae="_photoIcon_66tml_191",x={wrapper:ve,uploadBox:Ne,uploadAnotherSpan:We,customUploadBtn:ze,imagePreview:Ce,btnWrapper:Te,photoIcon:Ae},Se=({register:r,setValue:c,imagePreview:l,setImagePreview:d,errors:t,watch:o})=>(y.useEffect(()=>{const a=o(m=>{m.thumb[0]&&d(URL.createObjectURL(m.thumb[0]))&&c("thumb",m.thumb[0])});return()=>a.unsubscribe()},[o,d,c]),console.log(t),e.jsxs("div",{className:x.wrapper,children:[e.jsx("div",{className:x.uploadBox,children:e.jsxs("label",{className:x.customUploadBtn,children:[e.jsx(C,{type:"file",name:"thumb",register:r,setValue:c,errors:t}),l&&e.jsx("img",{src:l,alt:"Recipe Preview",className:x.imagePreview}),e.jsxs("div",{className:x.btnWrapper,children:[!l&&e.jsxs(e.Fragment,{children:[e.jsx(H,{iconId:"icon-capture-photo-camera",width:"50px",height:"50",customStyle:x.photoIcon}),e.jsx("span",{children:"Upload a photo"})]}),t.thumb&&e.jsx("p",{children:t.thumb.message})]})]})}),l&&e.jsxs("label",{className:x.uploadAnotherSpan,children:[e.jsx(C,{type:"file",name:"thumb",register:r,setValue:c,errors:t}),"Upload another photo"]})]})),Be="_container_zt6ti_1",qe="_textareaWrapper_zt6ti_13",De="_symbolCounter_zt6ti_21",Le="_textarea_zt6ti_13",$e="_inputQuantity_zt6ti_77",we="_buttonAdd_zt6ti_113",ke="_icon_zt6ti_151",Qe="_list_zt6ti_175",Ue="_listItem_zt6ti_187",Re="_imageWrapper_zt6ti_201",Pe="_image_zt6ti_201",Ee="_iconBtn_zt6ti_217",Ge="_textWrapper_zt6ti_249",Fe="_ingredientAndQuantity_zt6ti_259",i={container:Be,textareaWrapper:qe,symbolCounter:De,textarea:Le,inputQuantity:$e,buttonAdd:we,icon:ke,list:Qe,listItem:Ue,imageWrapper:Re,image:Pe,iconBtn:Ee,textWrapper:Ge,ingredientAndQuantity:Fe},Je="_iconBtn_sycip_1",Me="_icon_sycip_1",Oe="_counterInput_sycip_41",z={iconBtn:Je,icon:Me,counterInput:Oe},He=({cookingTime:r,setCookingTime:c})=>{const l=()=>{c(t=>t+1)},d=()=>{c(t=>t>1?t-1:1)};return e.jsxs("div",{children:[e.jsx("label",{children:"Cooking Time"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx(T,{iconId:"icon-minus",width:"16",height:"16",type:"button",style:z.iconBtn,styleSVG:z.icon,onClick:d}),e.jsx("div",{children:e.jsxs("span",{style:{margin:"0 12px"},children:[r," min"]})}),e.jsx(T,{iconId:"icon-plus",type:"button",width:"16",height:"16",style:z.iconBtn,styleSVG:z.icon,onClick:l})]})]})},Ke=({register:r,setValue:c,watch:l,ingredients:d,selectedIngredients:t,setSelectedIngredients:o,errors:a,categories:m,areas:A,cookingTime:S,setCookingTime:B,isIngredientsLoading:q,isCategoriesLoading:D,isAreasLoading:L})=>{var N;const[$,j]=y.useState(!1),u=l("ingredient"),b=l("measure"),f=()=>{if(u&&b){const n=d.find(h=>h._id===u.value);o([...t,{id:u.value,measure:b,imageUrl:n.img,label:u.label}]),c("ingredient",null),c("measure",""),j(!0)}},I=n=>{o(t.filter((h,w)=>w!==n)),t.length<=1&&j(!1)},v=n=>n?e.jsx(K,{}):null;return e.jsxs("div",{className:i.container,children:[e.jsxs("div",{className:i.textareaWrapper,children:[e.jsx("textarea",{...r("description"),maxLength:"200",placeholder:"Enter the description of the dish",className:i.textarea}),e.jsxs("span",{className:i.symbolCounter,children:[((N=l("description"))==null?void 0:N.length)||0,"/200"]}),a.description&&e.jsx("p",{children:a.description.message})]}),e.jsx("div",{className:i.categoryAndTime,children:v(D)||e.jsxs("div",{children:[e.jsx("label",{children:"Category"}),e.jsx(k,{options:m,placeholder:"Select a category",...r("category"),onChange:n=>c("category",n.label)}),a.category&&e.jsx("p",{children:a.category.message})]})}),e.jsx("div",{className:i.categoryAndTime,children:v(L)||e.jsxs("div",{children:[e.jsx("label",{children:"Area"}),e.jsx(k,{options:A,placeholder:"Select area",...r("area"),onChange:n=>c("area",n.label)}),a.area&&e.jsx("p",{children:a.area.message})]})}),e.jsxs("div",{children:[e.jsx(He,{cookingTime:S,setCookingTime:B}),a.cookingTime&&e.jsx("p",{children:a.cookingTime.message})]}),e.jsxs("div",{className:i.ingredientAndQuantity,children:[q?e.jsx("p",{children:"Loading..."}):e.jsxs("div",{children:[e.jsx("label",{children:"Ingredient"}),e.jsx(k,{options:d,placeholder:"Select an ingredient",className:i.select,...r("ingredient"),onChange:n=>c("ingredient",n)}),a.ingredient&&e.jsx("p",{children:a.ingredient.message})]}),e.jsxs("div",{children:[e.jsx(C,{type:"text",name:"measure",register:r,placeholder:"Enter quantity",classname:i.inputQuantity}),a.measure&&e.jsx("p",{children:a.measure.message})]})]}),$&&e.jsx("ul",{className:i.list,children:t.map((n,h)=>e.jsxs("li",{className:i.listItem,children:[e.jsx("div",{className:i.imageWrapper,children:e.jsx("img",{src:n.imageUrl,alt:n.label,width:"55px",height:"55px",className:i.image})}),e.jsxs("div",{className:i.textWrapper,children:[e.jsx("p",{children:n.label}),e.jsx("p",{children:n.measure})]}),e.jsx(T,{iconId:"icon-close-btn",type:"button",onClick:()=>I(h),style:i.iconBtn})]},h))}),e.jsx(P,{text:"Add ingredient +",type:"button",onClick:f,iconId:"icon-plus",classname:i.buttonAdd})]})},Ve="_formTitleWrapper_1hnv8_1",Xe="_fromDescription_1hnv8_37",Ye="_formTitle_1hnv8_1",R={formTitleWrapper:Ve,fromDescription:Xe,formTitle:Ye},Ze=()=>e.jsx("div",{className:R.formTitleWrapper,children:e.jsx("p",{className:R.fromDescription,children:"Reveal your culinary art, share your favorite recipe and create gastronomic masterpieces with us."})}),st=()=>{var Q;const{register:r,handleSubmit:c,control:l,setValue:d,watch:t,formState:{errors:o},reset:a}=V({resolver:se(re),defaultValues:{selectedIngredients:[]}}),{data:m,isLoading:A}=X(),{data:S,isLoading:B}=Y(),{data:q,isLoading:D}=Z(),{data:L}=ee(),[$]=te(),[j,u]=y.useState([]),[b,f]=y.useState(null),[I,v]=y.useState(1),N=m,n=S,h=q,w=ne(),E=async g=>{const p=new FormData;p.append("thumb",g.thumb[0]),p.append("title",g.title),p.append("description",g.description),p.append("category",g.category),p.append("area",g.area),p.append("time",I.toString()),p.append("instructions",g.instructions);const F=j.map(W=>({id:W.id,measure:W.measure}));p.append("ingredients",JSON.stringify(F));try{await $(p),w(`/user/${L.id}`)}catch(W){alert("Error: "+W.response.data.message)}},G=()=>{a(),f(null),u([])};return e.jsxs("div",{className:s.container,children:[e.jsx(ae,{currentPage:"Add Recipe"}),e.jsxs("div",{className:s.titleWrapper,children:[e.jsx(ie,{text:"add recipe"}),e.jsx(Ze,{})]}),e.jsx("form",{onSubmit:c(E),className:s.form,children:e.jsxs("div",{className:s.formWrapper,children:[e.jsx(Se,{register:r,setValue:d,imagePreview:b,setImagePreview:f,watch:t,errors:o}),e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx(C,{type:"text",name:"title",register:r,placeholder:"The name of the recipe",classname:s.nameInput}),o.title&&e.jsx("p",{children:o.title.message})]}),e.jsx("div",{className:s.recipeData,children:e.jsx("div",{className:s.categoryAndTime,children:e.jsxs("div",{className:s.recipeData,children:[e.jsx(Ke,{control:l,register:r,setValue:d,watch:t,categories:N,areas:h,cookingTime:I,setCookingTime:v,ingredients:n,selectedIngredients:j,setSelectedIngredients:u,errors:o,isCategoriesLoading:A,isIngredientsLoading:B,isAreasLoading:D}),o.selectedIngredients&&e.jsx("p",{className:s.error,children:o.selectedIngredients.message})]})})}),e.jsxs("div",{className:s.recipeIncstructions,children:[e.jsx("label",{className:s.labelPrep,children:"Recipe preparation"}),e.jsxs("div",{className:s.textareaWrapper,children:[e.jsx("textarea",{...r("instructions"),placeholder:"Enter recipe",maxLength:"200",className:s.textarea}),e.jsxs("span",{className:s.symbolCounter,children:[((Q=t("instructions"))==null?void 0:Q.length)||0,"/200"]}),o.instructions&&e.jsx("p",{children:o.instructions.message})]})]}),e.jsxs("div",{className:s.buttonWrapper,children:[e.jsx(T,{iconId:"icon-trash",type:"button",onClick:G,width:"20",height:"20",style:s.trashBtn,styleSVG:s.iconTrash}),e.jsx(P,{text:"Publish",type:"submit",classname:s.button})]})]})]})})]})};export{st as default};
