import{j as e,k as j,z as H,_ as J,N as $,M as R,A as X,u as E,B as k,F as z,$ as A,r as p,a0 as K,a1 as ee,a2 as se,a3 as te,a4 as re,a5 as ae,a6 as oe,L as ne,a7 as ie,a8 as ce,w as O,v as le,a9 as pe,aa as de,ab as _e,Z as ue,C as fe,ac as me}from"./index-ClPNBpSU.js";import{S as he}from"./SectionTitle-B4iEwy4g.js";import{B as ge}from"./BreadCrumbs-B9OIvpl1.js";const xe="_container_1nv0s_1",ve="_content_1nv0s_13",je="_message_1nv0s_21",g={container:xe,content:ve,message:je},be="_menuContainer_gij54_1",we="_menuItem_gij54_29",Ce="_active_gij54_75",F={menuContainer:be,menuItem:we,active:Ce},ye=({menuItems:s,activeTab:r,setActiveTab:t})=>e.jsx("div",{className:F.menuContainer,children:s.map(a=>e.jsx("div",{className:`${F.menuItem} ${a.id===r?F.active:""}`,onClick:()=>t(a.id),children:a.label},a.id))}),Ne=s=>s.profile.userProfile,B=s=>s.profile.isAuthorizedUser,Pe=s=>s.profile.followers,Le=s=>s.profile.following,Ie=s=>s.profile.favoritesRecipes,We="_recipeCard_zbyhy_1",Re={recipeCard:We},D=({imgUrl:s,title:r})=>e.jsx("div",{className:Re.recipeCard,children:e.jsx("img",{src:s,alt:r})}),Ue="_recipeCardWrapper_aqgmv_1",Fe="_flexPhotoWrapper_aqgmv_11",Te="_recipeTextWrapper_aqgmv_21",Se="_recipeInstructions_aqgmv_31",Ae="_recipeTitle_aqgmv_53",Be="_buttonWrapper_aqgmv_69",Ee="_recipeCardList_aqgmv_79",Oe="_iconBtn_aqgmv_91",$e="_icon_aqgmv_91",u={recipeCardWrapper:Ue,flexPhotoWrapper:Fe,recipeTextWrapper:Te,recipeInstructions:Se,recipeTitle:Ae,buttonWrapper:Be,recipeCardList:Ee,iconBtn:Oe,icon:$e},ke=({data:s,tab:r})=>{const t=j(B),[a]=H(),[i]=J(),c=()=>{r==="recipe"?i(s._id):X(a,s._id,"delete")};return e.jsxs("li",{className:u.recipeCardWrapper,children:[e.jsxs("div",{className:u.flexPhotoWrapper,children:[e.jsx(D,{imgUrl:s.thumb,title:s.title}),e.jsxs("div",{className:u.recipeTextWrapper,children:[e.jsxs("h5",{className:u.recipeTitle,children:[" ",s.title," "]}),e.jsx("p",{className:u.recipeInstructions,children:s.instructions})]})]}),e.jsxs("div",{className:u.buttonWrapper,children:[e.jsx($,{to:`/recipe/${s._id}`,children:e.jsx(R,{iconId:"icon-arrow-up-right",style:u.iconBtn,styleSVG:u.icon})}),t&&e.jsx(R,{iconId:"icon-trash",onClick:c,style:u.iconBtn,styleSVG:u.icon})]})]})},T=({data:s,tab:r})=>e.jsx("ul",{className:u.recipeCardList,children:s.map(t=>e.jsx(ke,{data:t,tab:r},t._id))}),ze="_cardWrapper_bt2lx_1",De="_photoWrapper_bt2lx_15",Me="_smallProfilePhoto_bt2lx_41",qe="_followerData_bt2lx_51",Ve="_name_bt2lx_61",Qe="_descr_bt2lx_77",Ge="_followerCardList_bt2lx_91",Ye="_iconBtn_bt2lx_99",Ze="_icon_bt2lx_99",He="_recipesList_bt2lx_157",Je="_recipeCard_bt2lx_167",f={cardWrapper:ze,photoWrapper:De,smallProfilePhoto:Me,followerData:qe,name:Ve,descr:Qe,followerCardList:Ge,iconBtn:Ye,icon:Ze,recipesList:He,recipeCard:Je},Xe=({data:s,btnText:r})=>{var i;const t=E(768,!1,3),a=E(1440,3,4);return e.jsxs("li",{className:f.cardWrapper,children:[e.jsxs("div",{className:f.followerData,children:[e.jsx("div",{className:f.photoWrapper,children:e.jsx("img",{src:s.avatarURL||"https://gravatar.com/avatar/000000000000000000000000000000000000000000000000000000?d=mp",className:f.smallProfilePhoto,alt:"User avatar"})}),e.jsxs("div",{children:[e.jsxs("h5",{className:f.name,children:[" ",s.name]}),e.jsxs("p",{className:f.descr,children:["Own recipes: ",s.totalRecipes]}),e.jsx(k,{text:r,variant:"follow_user"})]})]}),t&&e.jsx("ul",{className:f.recipesList,children:(i=s==null?void 0:s.recipes)==null?void 0:i.map((c,_)=>{if(_<a)return e.jsx("li",{children:e.jsx(D,{imgUrl:c.thumb,title:c.title})},c._id)})}),e.jsx($,{to:`/user/${s._id}`,children:e.jsx(R,{iconId:"icon-arrow-up-right",style:f.iconBtn,styleSVG:f.icon})})]})},S=({data:s,btnText:r})=>e.jsx("ul",{className:f.followerCardList,children:s.map(t=>e.jsx(Xe,{data:t,btnText:r},t._id))}),v=[{id:"my-recipes",label:"MY RECIPES",message:"Nothing has been added to your recipes list yet. Please browse our recipes and add your favorites for easy access in the future."},{id:"my-favorites",label:"MY FAVORITES",message:"Nothing has been added to your favorite recipes list yet. Please browse our recipes and add your favorites for easy access in the future."},{id:"followers",label:"FOLLOWERS",message:"There are currently no followers on your account. Please engage our visitors with interesting content and draw their attention to your profile."},{id:"following",label:"FOLLOWING",message:"Your account currently has no subscriptions to other users. Learn more about our users and select those whose content interests you."}],N=[{id:"recipes",label:"RECIPES",message:"The current user hasn't added any recipes yet."},{id:"followers",label:"FOLLOWERS",message:"The current user hasn't any followers yet."}],Ke=()=>{const{id:s}=z(),r=A(),t=j(B),a=j(Pe),i=j(Le),c=j(Ie),[_,P]=p.useState(1),[L,x]=p.useState(0),[o,C]=p.useState(t?v[0].id:N[0].id),{data:d,isLoading:n}=K({userId:s,page:_});p.useEffect(()=>{P(1)},[o]);const h=({selected:y})=>{P(y+1)};p.useEffect(()=>{C(t?v[0].id:N[0].id)},[t]);const{data:l,isLoading:M}=ee({page:_,skip:o!=="my-favorites"}),{data:I,isLoading:q}=se({userId:s,page:_,skip:o!=="followers"}),{data:W,isLoading:V}=te({skip:o!=="following",page:_}),Q=n||M||q||V;p.useEffect(()=>{if(n||x(d.totalPages),o==="followers"&&I)x(I.totalPages),r(re(I.followersWithRecipes));else if(o==="following"&&W)x(W.totalPages),r(ae(W.followingWithRecipes));else if(o==="my-favorites"&&l){x(l.totalPages);const y=l==null?void 0:l.data.map(U=>U.recipe);r(oe({data:y}))}},[o,r,I,W,l,n,d,_]);const b=(y,U)=>y.find(({id:Z})=>Z===U).message,G=()=>{if(t)switch(o){case"my-recipes":return(d==null?void 0:d.total)>0?e.jsx(T,{data:d.data,tab:"recipe"}):e.jsx("p",{className:g.message,children:b(v,o)});case"my-favorites":return(c==null?void 0:c.length)>0?e.jsx(T,{data:c,tab:"favorites"}):e.jsx("p",{className:g.message,children:b(v,o)});case"followers":return(a==null?void 0:a.length)>0?e.jsx(S,{data:a,btnText:"follow"}):e.jsx("p",{className:g.message,children:b(v,o)});case"following":return(i==null?void 0:i.length)>0?e.jsx(S,{data:i,btnText:"unfollow"}):e.jsx("p",{className:g.message,children:b(v,o)});default:return null}else switch(o){case"recipes":return(d==null?void 0:d.total)>0?e.jsx(T,{data:d.data}):e.jsx("p",{className:g.message,children:b(N,o)});case"followers":return(a==null?void 0:a.length)>0?e.jsx(S,{data:a,btnText:"follow"}):e.jsx("p",{className:g.message,children:b(N,o)});default:return null}},Y=t?v:N;return e.jsxs("div",{className:g.container,children:[e.jsx(ye,{menuItems:Y,activeTab:o,setActiveTab:C}),Q?e.jsx(ne,{}):e.jsx("div",{className:g.content,children:G()}),L>1&&e.jsx(ie,{pageCount:L,onPageChange:h,currentPage:_})]})},es="_container_1ivx6_1",ss="_breadscrumbs_1ivx6_9",ts="_title_1ivx6_17",rs="_subtitle_1ivx6_23",as="_userInfoAndBtnWrapper_1ivx6_41",os="_userInfoAndTabContentWerapper_1ivx6_111",w={container:es,breadscrumbs:ss,title:ts,subtitle:rs,userInfoAndBtnWrapper:as,userInfoAndTabContentWerapper:os},ns="_profile_card_wrapper_hmtns_1",is="_profile_card_hmtns_1",cs="_profile_name_hmtns_41",ls="_profile_card_info_hmtns_59",ps="_profile_info_item_hmtns_73",ds="_profile_info_content_hmtns_93",_s="_profile_big_card_button_hmtns_109",us="_profile_big_card_icon_hmtns_127",fs="_profile_photo_hmtns_135",m={profile_card_wrapper:ns,profile_card:is,profile_name:cs,profile_card_info:ls,profile_info_item:ps,profile_info_content:ds,profile_big_card_button:_s,profile_big_card_icon:us,profile_photo:fs},ms=s=>s.charAt(0).toUpperCase()+s.slice(1),hs=({name:s,value:r})=>{const t={email:"email",createdRecipesCount:"added recipes",favoriteRecipesCount:"favorites",followersCount:"followers",followingCount:"following"};return e.jsxs("li",{className:m.profile_info_item,children:[ms(t[s]),":",e.jsx("span",{className:m.profile_info_content,children:r})]})},gs=()=>{const s=j(B),[r]=ce(),t=j(Ne),a=A(),i=t?Object.keys(t):[],[c,_]=p.useState((t==null?void 0:t.avatar)||O),P=async n=>{const h=new FormData;h.append("avatar",n);try{const l=await r(h).unwrap();_(l.avatarURL),a(pe(l.avatarURL))}catch(l){console.error("Error updating avatar:",l)}},L=n=>{const h=n.target.files[0];if(h){const l=new FileReader;l.onload=()=>{P(h)},l.readAsDataURL(h)}},x=p.useRef(null),[o,C]=p.useState({width:16,height:16}),d=()=>{x.current.click()};return p.useEffect(()=>{_((t==null?void 0:t.avatar)||O)},[t==null?void 0:t.avatar]),p.useEffect(()=>{const n=()=>{window.matchMedia("(max-width: 768px)").matches?C({width:16,height:16}):C({width:18,height:18})};return n(),window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}},[]),e.jsx("div",{className:m.profile_card_wrapper,children:e.jsxs("div",{className:m.profile_card,children:[e.jsx("img",{className:m.profile_photo,src:c,alt:`${(t==null?void 0:t.name)||"User Name"} avatar`}),s&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"file",ref:x,style:{display:"none"},onChange:L}),e.jsx(R,{iconId:"icon-plus",style:m.profile_big_card_button,styleSVG:m.profile_big_card_icon,stroke:"#FFF",width:o.width,height:o.height,onClick:d})]}),e.jsx("h3",{className:m.profile_name,children:t==null?void 0:t.name}),e.jsx("ul",{className:m.profile_info,children:i.map(n=>{if(!(n==="_id"||n==="name"||n==="avatar"))return e.jsx(hs,{name:n,value:t[n]},le())})})]})})},xs="toastId",Cs=()=>{const[s,r]=p.useState(!1),{id:t}=z(),a=A(),{data:i,error:c}=de(t);if(p.useEffect(()=>{i&&a(_e(i))},[i,a]),c){ue.error(c.data.message,{position:"top-right",toastId:xs});return}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:w.container,children:[e.jsx("div",{className:w.breadscrumbs,children:e.jsx(ge,{currentPage:"Profile"})}),e.jsx("div",{className:w.title,children:e.jsx(he,{text:"Profile"})}),e.jsxs("p",{className:w.subtitle,children:["Reveal your culinary art, share your favorite recipe and create ",e.jsx("br",{}),"gastronomic masterpieces with us."]}),e.jsxs("div",{className:w.userInfoAndTabContentWerapper,children:[e.jsxs("div",{className:w.userInfoAndBtnWrapper,children:[e.jsx(gs,{}),e.jsx(k,{type:"button",variant:"logOutBtn",text:"Log Out",onClick:()=>r(!0)})]}),e.jsx(Ke,{})]})]}),e.jsx(fe,{isOpen:s,onClose:()=>r(!1),children:e.jsx(me,{setModalLogOutOpen:r})})]})};export{Cs as default};
