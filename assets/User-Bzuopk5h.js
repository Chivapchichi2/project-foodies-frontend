import{j as e,Y as E,k as m,x as H,z as le,a0 as pe,N as J,M as A,$ as X,a1 as de,A as ue,u as Q,B as D,F as Z,r as d,a2 as fe,a3 as _e,a4 as me,a5 as he,a6 as z,a7 as ge,L as xe,a8 as we,a9 as ve,w as G,v as je,aa as be,ab as Ce,ac as ye,W as Ne,ad as Ie,ae as Fe,af as Pe,_ as U,C as Le,ag as Re,ah as Y}from"./index-Cyo0ixnP.js";import{s as K,a as B,b as ee,c as Ue,d as We}from"./profileSelectors-DjL7l0TR.js";import{S as Se}from"./SectionTitle-Bm-DDSX4.js";import{B as Te}from"./BreadCrumbs-pm3U-LFb.js";const Ae="_container_1nv0s_1",Ee="_content_1nv0s_13",Be="_message_1nv0s_21",y={container:Ae,content:Ee,message:Be},Oe="_menuContainer_gij54_1",ke="_menuItem_gij54_29",$e="_active_gij54_75",k={menuContainer:Oe,menuItem:ke,active:$e},Me=({menuItems:s,activeTab:o,setActiveTab:t})=>e.jsx("div",{className:k.menuContainer,children:s.map(a=>e.jsx("div",{className:`${k.menuItem} ${a.id===o?k.active:""}`,onClick:()=>t(a.id),children:a.label},a.id))}),De="_recipeCard_8rx53_1",ze="_recipeImg_8rx53_17",q={recipeCard:De,recipeImg:ze},se=({imgUrl:s,title:o})=>e.jsx("div",{className:q.recipeCard,children:e.jsx("img",{className:q.recipeImg,src:s,alt:o})}),Ve="_recipeCardWrapper_avu2p_1",Qe="_flexPhotoWrapper_avu2p_11",Ge="_recipeTextWrapper_avu2p_21",Ye="_recipeInstructions_avu2p_29",qe="_recipeTitle_avu2p_51",He="_buttonWrapper_avu2p_67",Je="_recipeCardList_avu2p_77",Xe="_iconBtn_avu2p_89",Ze="_icon_avu2p_89",v={recipeCardWrapper:Ve,flexPhotoWrapper:Qe,recipeTextWrapper:Ge,recipeInstructions:Ye,recipeTitle:qe,buttonWrapper:He,recipeCardList:Je,iconBtn:Xe,icon:Ze},Ke=({data:s,tab:o})=>{const t=E(),a=m(H),c=m(K),p=m(B),[u]=le(),[l]=pe(),n=()=>{o==="recipe"?(t(X(c.filter(f=>f._id!==s._id))),l(s._id)):(t(de(a.filter(f=>f!==s._id))),ue(u,s._id,"delete"))};return e.jsxs("li",{className:v.recipeCardWrapper,children:[e.jsxs("div",{className:v.flexPhotoWrapper,children:[e.jsx(se,{imgUrl:s.thumb,title:s.title}),e.jsxs("div",{className:v.recipeTextWrapper,children:[e.jsxs("h5",{className:v.recipeTitle,children:[" ",s.title," "]}),e.jsx("p",{className:v.recipeInstructions,children:s.instructions})]})]}),e.jsxs("div",{className:v.buttonWrapper,children:[e.jsx(J,{to:`/recipe/${s._id}`,children:e.jsx(A,{iconId:"icon-arrow-up-right",style:v.iconBtn,styleSVG:v.icon})}),p&&e.jsx(A,{iconId:"icon-trash",onClick:n,style:v.iconBtn,styleSVG:v.icon})]})]})},$=({data:s,tab:o})=>e.jsx("ul",{className:v.recipeCardList,children:s.map(t=>e.jsx(Ke,{data:t,tab:o},t._id))}),es="_cardWrapper_bt2lx_1",ss="_photoWrapper_bt2lx_15",ts="_smallProfilePhoto_bt2lx_41",rs="_followerData_bt2lx_51",os="_name_bt2lx_61",as="_descr_bt2lx_77",is="_followerCardList_bt2lx_91",ns="_iconBtn_bt2lx_99",cs="_icon_bt2lx_99",ls="_recipesList_bt2lx_157",ps="_recipeCard_bt2lx_167",j={cardWrapper:es,photoWrapper:ss,smallProfilePhoto:ts,followerData:rs,name:os,descr:as,followerCardList:is,iconBtn:ns,icon:cs,recipesList:ls,recipeCard:ps},ds=({data:s,tab:o,handleFollowUser:t,handleUnfollowUser:a})=>{var l;const c=Q(768,!1,3),p=Q(1440,3,4),u=()=>{if(o==="followers")return s.isFollowing?"unfollow":"follow";if(o==="following")return"unfollow"};return e.jsxs("li",{className:j.cardWrapper,children:[e.jsxs("div",{className:j.followerData,children:[e.jsx("div",{className:j.photoWrapper,children:e.jsx("img",{src:s.avatarURL||"https://gravatar.com/avatar/000000000000000000000000000000000000000000000000000000?d=mp",className:j.smallProfilePhoto,alt:"User avatar"})}),e.jsxs("div",{children:[e.jsxs("h5",{className:j.name,children:[" ",s.name]}),e.jsxs("p",{className:j.descr,children:["Own recipes: ",s.totalRecipes]}),e.jsx(D,{text:u(),variant:"follow_user",onClick:()=>u()==="follow"?t(s._id):a(s._id)})]})]}),c&&e.jsx("ul",{className:j.recipesList,children:(l=s==null?void 0:s.recipes)==null?void 0:l.map((n,f)=>{if(f<p)return e.jsx("li",{children:e.jsx(se,{imgUrl:n.thumb,title:n.title})},n._id)})}),e.jsx(J,{to:`/user/${s._id}`,children:e.jsx(A,{iconId:"icon-arrow-up-right",style:j.iconBtn,styleSVG:j.icon})})]})},M=({data:s,tab:o,handleFollowUser:t,handleUnfollowUser:a})=>e.jsx("ul",{className:j.followerCardList,children:s.map(c=>e.jsx(ds,{data:c,tab:o,handleFollowUser:t,handleUnfollowUser:a},c._id))}),N=[{id:"my-recipes",label:"MY RECIPES",message:"Nothing has been added to your recipes list yet. Please browse our recipes and add your favorites for easy access in the future."},{id:"my-favorites",label:"MY FAVORITES",message:"Nothing has been added to your favorite recipes list yet. Please browse our recipes and add your favorites for easy access in the future."},{id:"followers",label:"FOLLOWERS",message:"There are currently no followers on your account. Please engage our visitors with interesting content and draw their attention to your profile."},{id:"following",label:"FOLLOWING",message:"Your account currently has no subscriptions to other users. Learn more about our users and select those whose content interests you."}],W=[{id:"recipes",label:"RECIPES",message:"The current user hasn't added any recipes yet."},{id:"followers",label:"FOLLOWERS",message:"The current user hasn't any followers yet."}],us=({handleFollowUser:s,handleUnfollowUser:o})=>{const{id:t}=Z(),a=E(),c=m(B),p=m(ee),u=m(Ue),l=d.useRef(null),n=m(K),f=m(H),[h,_]=d.useState(1),[I,i]=d.useState(0),[r,g]=d.useState(c?N[0].id:W[0].id),{data:x,isLoading:F}=fe({userId:t,page:h},{skip:r!=="my-recipes"&&r!=="recipes"});d.useEffect(()=>{_(1)},[r]);const b=({selected:L})=>{_(L+1),l.current&&l.current.scrollIntoView({behavior:"smooth"})};d.useEffect(()=>{g(c?N[0].id:W[0].id)},[c]);const{data:w,isLoading:te}=_e({page:h,limit:10,skip:r!=="my-favorites"}),{data:S,isLoading:re}=me({userId:t,page:h,skip:r!=="followers"}),{data:T,isLoading:oe}=he({skip:r!=="following",page:h}),ae=F||te||re||oe;d.useEffect(()=>{x&&!F&&(i(x.totalPages),a(X(x.data))),r==="followers"&&S?(i(S.totalPages),a(z(S.followersWithRecipes))):r==="following"&&T?(i(T.totalPages),a(ge(T.followingWithRecipes))):r==="my-favorites"&&w&&i(w.totalPages)},[r,a,S,T,w,F,x,h,f]);const P=(L,O)=>L.find(({id:ce})=>ce===O).message,ie=()=>{var L;if(c)switch(r){case"my-recipes":return(n==null?void 0:n.length)>0?e.jsx($,{data:n,tab:"recipe"}):e.jsx("p",{className:y.message,children:P(N,r)});case"my-favorites":if(((L=w.data)==null?void 0:L.length)>0){const O=w==null?void 0:w.data.map(V=>V.recipe);return e.jsx($,{data:O,tab:"favorites"})}else return e.jsx("p",{className:y.message,children:P(N,r)});case"followers":return(p==null?void 0:p.length)>0?e.jsx(M,{handleFollowUser:s,handleUnfollowUser:o,data:p,tab:"followers"}):e.jsx("p",{className:y.message,children:P(N,r)});case"following":return(u==null?void 0:u.length)>0?e.jsx(M,{handleFollowUser:s,handleUnfollowUser:o,data:u,tab:"following"}):e.jsx("p",{className:y.message,children:P(N,r)});default:return null}else switch(r){case"recipes":return(x==null?void 0:x.total)>0?e.jsx($,{data:x.data}):e.jsx("p",{className:y.message,children:P(W,r)});case"followers":return(p==null?void 0:p.length)>0?e.jsx(M,{handleFollowUser:s,handleUnfollowUser:o,data:p,tab:"followers"}):e.jsx("p",{className:y.message,children:P(W,r)});default:return null}},ne=c?N:W;return e.jsxs("div",{className:y.container,ref:l,children:[e.jsx(Me,{menuItems:ne,activeTab:r,setActiveTab:g}),ae?e.jsx(xe,{}):e.jsx("div",{className:y.content,children:ie()}),I>1&&e.jsx(we,{pageCount:I,onPageChange:b,currentPage:h})]})},fs="_container_1ivx6_1",_s="_breadscrumbs_1ivx6_9",ms="_title_1ivx6_17",hs="_subtitle_1ivx6_23",gs="_userInfoAndBtnWrapper_1ivx6_41",xs="_userInfoAndTabContentWerapper_1ivx6_111",R={container:fs,breadscrumbs:_s,title:ms,subtitle:hs,userInfoAndBtnWrapper:gs,userInfoAndTabContentWerapper:xs},ws="_profile_card_wrapper_1iacj_1",vs="_profile_card_1iacj_1",js="_profile_name_1iacj_43",bs="_profile_card_info_1iacj_61",Cs="_profile_info_item_1iacj_75",ys="_profile_info_content_1iacj_95",Ns="_profile_big_card_button_1iacj_111",Is="_profile_big_card_icon_1iacj_129",Fs="_profile_photo_1iacj_137",C={profile_card_wrapper:ws,profile_card:vs,profile_name:js,profile_card_info:bs,profile_info_item:Cs,profile_info_content:ys,profile_big_card_button:Ns,profile_big_card_icon:Is,profile_photo:Fs},Ps=s=>s.charAt(0).toUpperCase()+s.slice(1),Ls=({name:s,value:o})=>{const t={email:"email",createdRecipesCount:"added recipes",favoriteRecipesCount:"favorites",followersCount:"followers",followingCount:"following"};return e.jsxs("li",{className:C.profile_info_item,children:[Ps(t[s]),":",e.jsx("span",{className:C.profile_info_content,children:o})]})},Rs=()=>{const s=m(B),[o]=ve(),t=m(We),a=E(),c=t?Object.keys(t):[],[p,u]=d.useState((t==null?void 0:t.avatar)||G),l=async i=>{const r=new FormData;r.append("avatar",i);try{const g=await o(r).unwrap();u(g.avatarURL),a(be(g.avatarURL))}catch(g){console.error("Error updating avatar:",g)}},n=i=>{const r=i.target.files[0];if(r){const g=new FileReader;g.onload=()=>{l(r)},g.readAsDataURL(r)}},f=d.useRef(null),[h,_]=d.useState({width:16,height:16}),I=()=>{f.current.click()};return d.useEffect(()=>{u((t==null?void 0:t.avatar)||G)},[t==null?void 0:t.avatar]),d.useEffect(()=>{const i=()=>{window.matchMedia("(max-width: 768px)").matches?_({width:16,height:16}):_({width:18,height:18})};return i(),window.addEventListener("resize",i),()=>{window.removeEventListener("resize",i)}},[]),e.jsx("div",{className:C.profile_card_wrapper,children:e.jsxs("div",{className:C.profile_card,children:[e.jsx("img",{className:C.profile_photo,src:p,alt:`${(t==null?void 0:t.name)||"User Name"} avatar`}),s&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"file",ref:f,style:{display:"none"},onChange:n}),e.jsx(A,{iconId:"icon-plus",style:C.profile_big_card_button,styleSVG:C.profile_big_card_icon,stroke:"#FFF",width:h.width,height:h.height,onClick:I})]}),e.jsx("h3",{className:C.profile_name,children:t==null?void 0:t.name}),e.jsx("ul",{className:C.profile_info,children:c.map(i=>{if(!(i==="_id"||i==="name"||i==="avatar"))return e.jsx(Ls,{name:i,value:t[i]},je())})})]})})},Us="toastId",Es=()=>{const s=m(Ce),[o,t]=d.useState(!1),[a,c]=d.useState(!1),p=m(B),u=m(ee),{id:l}=Z(),n=E(),{data:f,error:h}=ye(l),{data:_}=Ne(),[I,{error:i}]=Ie(),[r,{error:g}]=Fe(),x=b=>{if(I(b),i){U.error("Something went wrong",{position:"top-right"});return}n(Y({..._,following:[..._.following,b]})),n(z([...u])),c(!0),U.success("Follow successful",{position:"top-right"})},F=b=>{if(r(b),g){U.error("Something went wrong",{position:"top-right"});return}n(Y({..._,following:_.following.filter(w=>w!==b)})),n(z([...u])),c(!1),U.success("Unfollow successful",{position:"top-right"})};if(d.useEffect(()=>{if(l!==s&&_&&_.following){const b=_.following.some(w=>w===l);c(b)}},[_,l,s]),d.useEffect(()=>{f&&n(Pe(f))},[f,n]),h){U.error(h.data.message,{position:"top-right",toastId:Us});return}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:R.container,children:[e.jsx("div",{className:R.breadscrumbs,children:e.jsx(Te,{currentPage:"Profile"})}),e.jsx("div",{className:R.title,children:e.jsx(Se,{text:"Profile"})}),e.jsxs("p",{className:R.subtitle,children:["Reveal your culinary art, share your favorite recipe and create ",e.jsx("br",{}),"gastronomic masterpieces with us."]}),e.jsxs("div",{className:R.userInfoAndTabContentWerapper,children:[e.jsxs("div",{className:R.userInfoAndBtnWrapper,children:[e.jsx(Rs,{}),p?e.jsx(D,{type:"button",variant:"logoutOrFollowBtn",text:"Log Out",onClick:()=>t(!0)}):e.jsx(D,{type:"button",variant:"logoutOrFollowBtn",text:a?"Unfollow":"Follow",onClick:a?()=>F(l):()=>x(l)})]}),e.jsx(us,{handleFollowUser:x,handleUnfollowUser:F})]})]}),e.jsx(Le,{isOpen:o,onClose:()=>t(!1),children:e.jsx(Re,{setModalLogOutOpen:t})})]})};export{Es as default};
