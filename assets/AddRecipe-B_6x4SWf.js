import{H as K,J as y,r as j,j as e,K as T,I as V,M as A,P as w,B as E,L as X,Q as Y,T as Z,U as ee,V as te,W as se,X as re,k as ne,Y as ae,l as ie,Z as ce,_ as Q,$ as oe}from"./index-BsUuG_T_.js";import{B as le}from"./BreadCrumbs-DbxjM4SV.js";import{S as pe}from"./SectionTitle-BdXr8mkq.js";import{s as de}from"./profileSelectors-DjL7l0TR.js";const me=K().shape({title:y().required("Title is required"),description:y().max(200,"Description must be at most 200 characters").required("Description is required"),category:y().required("Category is required"),area:y().required("Area is required"),instructions:y().max(200,"Instructions must be at most 200 characters").required("Instructions are required")}),ue="_container_193rh_1",he="_breaCrumbs_193rh_25",_e="_titleWrapper_193rh_33",xe="_titleAndCrumpsWraper_193rh_41",ge="_formWrapper_193rh_57",je="_form_193rh_57",be="_nameInput_193rh_101",ye="_nameInputWrapper_193rh_129",Ie="_errorTitle_193rh_135",fe="_errorMsg_193rh_153",Ne="_textareaWrapper_193rh_191",ve="_textarea_193rh_191",We="_labelPrep_193rh_235",Ce="_symbolCounter_193rh_255",Te="_recipeData_193rh_269",Ae="_recipeIncstructions_193rh_281",Be="_buttonWrapper_193rh_289",Se="_button_193rh_289",Me="_trashBtn_193rh_321",De="_iconTrash_193rh_337",Le="_categoryAndTime_193rh_419",t={container:ue,breaCrumbs:he,titleWrapper:_e,titleAndCrumpsWraper:xe,formWrapper:ge,form:je,nameInput:be,nameInputWrapper:ye,errorTitle:Ie,errorMsg:fe,textareaWrapper:Ne,textarea:ve,labelPrep:We,symbolCounter:Ce,recipeData:Te,recipeIncstructions:Ae,buttonWrapper:Be,button:Se,trashBtn:Me,iconTrash:De,categoryAndTime:Le},$e="_errorMsg_1gh9h_9",Re="_wrapper_1gh9h_21",Ue="_uploadBox_1gh9h_39",ke="_uploadAnotherSpan_1gh9h_63",we="_customUploadBtn_1gh9h_85",Qe="_imagePreview_1gh9h_109",qe="_btnWrapper_1gh9h_129",Pe="_photoIcon_1gh9h_203",u={errorMsg:$e,wrapper:Re,uploadBox:Ue,uploadAnotherSpan:ke,customUploadBtn:we,imagePreview:Qe,btnWrapper:qe,photoIcon:Pe},Ee=({register:n,setValue:r,imagePreview:o,setImagePreview:p,errors:a,watch:l})=>(j.useEffect(()=>{const c=l(h=>{h.thumb[0]&&(p(URL.createObjectURL(h.thumb[0])),r("thumb",h.thumb[0]))});return()=>c.unsubscribe()},[l,p,r]),e.jsxs("div",{className:u.wrapper,children:[e.jsx("div",{className:u.uploadBox,children:e.jsxs("label",{className:u.customUploadBtn,children:[e.jsx(T,{type:"file",name:"thumb",register:n,setValue:r,errors:a}),o&&e.jsx("img",{src:o,alt:"Recipe Preview",className:u.imagePreview}),e.jsxs("div",{className:u.btnWrapper,children:[!o&&e.jsxs(e.Fragment,{children:[e.jsx(V,{iconId:"icon-capture-photo-camera",width:"50px",height:"50",customStyle:u.photoIcon}),e.jsx("span",{children:"Upload a photo"})]}),a.thumb&&e.jsx("p",{className:u.errorMsg,children:a.thumb.message})]})]})}),o&&e.jsxs("label",{className:u.uploadAnotherSpan,children:[e.jsx(T,{type:"file",name:"thumb",register:n,setValue:r,errors:a}),"Upload another photo"]})]})),Ge="_container_11pdu_1",Fe="_errorMsg_11pdu_13",He="_textareaWrapper_11pdu_25",Je="_symbolCounter_11pdu_33",Oe="_textarea_11pdu_25",ze="_inputQuantity_11pdu_97",Ke="_buttonAdd_11pdu_145",Ve="_addBtnIcon_11pdu_181",Xe="_icon_11pdu_207",Ye="_list_11pdu_231",Ze="_listItem_11pdu_243",et="_imageWrapper_11pdu_257",tt="_image_11pdu_257",st="_iconBtn_11pdu_273",rt="_textWrapper_11pdu_305",nt="_ingredientAndQuantity_11pdu_315",s={container:Ge,errorMsg:Fe,textareaWrapper:He,symbolCounter:Je,textarea:Oe,inputQuantity:ze,buttonAdd:Ke,addBtnIcon:Ve,icon:Xe,list:Ye,listItem:Ze,imageWrapper:et,image:tt,iconBtn:st,textWrapper:rt,ingredientAndQuantity:nt},at="_iconBtn_sycip_1",it="_icon_sycip_1",ct="_counterInput_sycip_41",C={iconBtn:at,icon:it,counterInput:ct},ot=({cookingTime:n,setCookingTime:r})=>{const o=()=>{r(a=>a+1)},p=()=>{r(a=>a>1?a-1:1)};return e.jsxs("div",{children:[e.jsx("label",{children:"Cooking Time"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx(A,{iconId:"icon-minus",width:"16",height:"16",type:"button",style:C.iconBtn,styleSVG:C.icon,onClick:p}),e.jsx("div",{children:e.jsxs("span",{style:{margin:"0 12px"},children:[n," min"]})}),e.jsx(A,{iconId:"icon-plus",type:"button",width:"16",height:"16",style:C.iconBtn,styleSVG:C.icon,onClick:o})]})]})},G=n=>{j.useEffect(()=>{const r=document.querySelector(`.${n}`),o=p=>{r.style.height="36px",r.style.height=`${p.target.scrollHeight}px`};return r.addEventListener("input",o),()=>{r.removeEventListener("input",o)}},[n])},lt=({register:n,setValue:r,watch:o,ingredients:p,selectedIngredients:a,setSelectedIngredients:l,errors:c,categories:h,areas:B,cookingTime:S,setCookingTime:M,isIngredientsLoading:D,isCategoriesLoading:L,isAreasLoading:$})=>{var W;const[R,b]=j.useState(!1),_=o("ingredient"),I=o("measure"),f=()=>{if(_&&I){const i=p.find(x=>x._id===_.value);l([...a,{id:_.value,measure:I,imageUrl:i.img,label:_.label}]),r("ingredient",null),r("measure",""),b(!0)}},N=i=>{l(a.filter((x,U)=>U!==i)),a.length<=1&&b(!1)},v=i=>i?e.jsx(X,{}):null;return G(s.textarea),e.jsxs("div",{className:s.container,children:[e.jsxs("div",{className:s.textareaWrapper,children:[e.jsx("textarea",{...n("description"),name:"description",maxLength:"200",placeholder:"Enter the description of the dish",className:s.textarea}),e.jsxs("span",{className:s.symbolCounter,children:[((W=o("description"))==null?void 0:W.length)||0,"/200"]}),c.description&&e.jsx("p",{className:s.errorMsg,children:c.description.message})]}),e.jsx("div",{className:s.categoryAndTime,children:v(L)||e.jsxs("div",{children:[e.jsx("label",{children:"Category"}),e.jsx(w,{options:h,placeholder:"Select a category",...n("category"),onChange:i=>r("category",i.label)}),c.category&&e.jsx("p",{className:s.errorMsg,children:c.category.message})]})}),e.jsx("div",{className:s.categoryAndTime,children:v($)||e.jsxs("div",{children:[e.jsx("label",{children:"Area"}),e.jsx(w,{options:B,placeholder:"Select area",...n("area"),onChange:i=>r("area",i.label)}),c.area&&e.jsx("p",{className:s.errorMsg,children:c.area.message})]})}),e.jsxs("div",{children:[e.jsx(ot,{cookingTime:S,setCookingTime:M}),c.cookingTime&&e.jsx("p",{className:s.errorMsg,children:c.cookingTime.message})]}),e.jsxs("div",{className:s.ingredientAndQuantity,children:[D?e.jsx("p",{children:"Loading..."}):e.jsxs("div",{children:[e.jsx("label",{children:"Ingredient"}),e.jsx(w,{options:p,placeholder:"Select an ingredient",className:s.select,...n("ingredient"),onChange:i=>r("ingredient",i)}),c.ingredient&&e.jsx("p",{className:s.errorMsg,children:c.ingredient.message})]}),e.jsxs("div",{children:[e.jsx(T,{type:"text",name:"measure",register:n,placeholder:"Enter quantity",classname:s.inputQuantity}),c.measure&&e.jsx("p",{className:s.errorMsg,children:c.measure.message})]})]}),R&&e.jsx("ul",{className:s.list,children:a.map((i,x)=>e.jsxs("li",{className:s.listItem,children:[e.jsx("div",{className:s.imageWrapper,children:e.jsx("img",{src:i.imageUrl,alt:i.label,width:"55px",height:"55px",className:s.image})}),e.jsxs("div",{className:s.textWrapper,children:[e.jsx("p",{children:i.label}),e.jsx("p",{children:i.measure})]}),e.jsx(A,{iconId:"icon-close-btn",type:"button",onClick:()=>N(x),style:s.iconBtn})]},x))}),e.jsx(E,{text:"Add ingredient",type:"button",onClick:f,iconId:"icon-plus",iconStyle:s.addBtnIcon,classname:s.buttonAdd})]})},pt="_formTitleWrapper_1hnv8_1",dt="_fromDescription_1hnv8_37",mt="_formTitle_1hnv8_1",P={formTitleWrapper:pt,fromDescription:dt,formTitle:mt},ut=()=>e.jsx("div",{className:P.formTitleWrapper,children:e.jsx("p",{className:P.fromDescription,children:"Reveal your culinary art, share your favorite recipe and create gastronomic masterpieces with us."})}),jt=()=>{var q;const{register:n,handleSubmit:r,control:o,setValue:p,watch:a,formState:{errors:l},reset:c}=Y({resolver:ce(me),defaultValues:{selectedIngredients:[]}}),{data:h,isLoading:B}=Z(),{data:S,isLoading:M}=ee(),{data:D,isLoading:L}=te(),{data:$}=se(),[R]=re(),[b,_]=j.useState([]),[I,f]=j.useState(null),[N,v]=j.useState(1),W=ne(de),i=ae(),x=h,U=S,F=D,H=ie(),k="toastId",J=async g=>{const d=new FormData;d.append("thumb",g.thumb),d.append("title",g.title),d.append("description",g.description),d.append("category",g.category),d.append("area",g.area),d.append("time",N.toString()),d.append("instructions",g.instructions);const z=b.map(m=>({id:m.id,measure:m.measure}));d.append("ingredients",JSON.stringify(z));try{const m=await R(d);m.error?Q.error(m.error.data.message,{toastId:k}):(i(oe([...W,m.data])),H(`/user/${$.id}`),Q.success("Sign In successful",{toastId:k}),c())}catch(m){Q.error(m.message,{toastId:k})}},O=()=>{c(),f(null),_([])};return G(t.textarea),e.jsxs("div",{className:t.container,children:[e.jsxs("div",{className:t.titleAndCrumpsWraper,children:[e.jsx("div",{className:t.breaCrumbs,children:e.jsx(le,{currentPage:"Add Recipe"})}),e.jsxs("div",{className:t.titleWrapper,children:[e.jsx(pe,{text:"add recipe"}),e.jsx(ut,{})]})]}),e.jsx("form",{onSubmit:r(J),className:t.form,children:e.jsxs("div",{className:t.formWrapper,children:[e.jsx(Ee,{register:n,setValue:p,imagePreview:I,setImagePreview:f,watch:a,errors:l}),e.jsxs("div",{children:[e.jsxs("div",{className:t.nameInputWrapper,children:[e.jsx(T,{type:"text",name:"title",register:n,placeholder:"The name of the recipe",classname:t.nameInput}),l.title&&e.jsx("p",{className:t.errorTitle,children:l.title.message})]}),e.jsx("div",{className:t.recipeData,children:e.jsx("div",{className:t.categoryAndTime,children:e.jsxs("div",{className:t.recipeData,children:[e.jsx(lt,{control:o,register:n,setValue:p,watch:a,categories:x,areas:F,cookingTime:N,setCookingTime:v,ingredients:U,selectedIngredients:b,setSelectedIngredients:_,errors:l,isCategoriesLoading:B,isIngredientsLoading:M,isAreasLoading:L}),l.selectedIngredients&&e.jsx("p",{className:t.errorMsg,children:l.selectedIngredients.message})]})})}),e.jsxs("div",{className:t.recipeIncstructions,children:[e.jsx("label",{className:t.labelPrep,children:"Recipe preparation"}),e.jsxs("div",{className:t.textareaWrapper,children:[e.jsx("textarea",{...n("instructions"),name:"instructions",placeholder:"Enter recipe",maxLength:"200",className:t.textarea}),e.jsxs("span",{className:t.symbolCounter,children:[((q=a("instructions"))==null?void 0:q.length)||0,"/200"]}),l.instructions&&e.jsx("p",{className:t.errorMsg,children:l.instructions.message})]})]}),e.jsxs("div",{className:t.buttonWrapper,children:[e.jsx(A,{iconId:"icon-trash",type:"button",onClick:O,width:"20",height:"20",style:t.trashBtn,styleSVG:t.iconTrash}),e.jsx(E,{text:"Publish",type:"submit",classname:t.button})]})]})]})})]})};export{jt as default};
