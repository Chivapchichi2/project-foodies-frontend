import{H as K,J as b,r as j,j as e,K as A,I as V,M as B,P as w,B as E,L as X,Q as Y,T as Z,U as ee,V as te,W as se,X as ne,k as re,Y as ae,l as ie,Z as oe,_ as Q,$ as ce}from"./index-3FrcfW5i.js";import{B as le}from"./BreadCrumbs-CTIxXnem.js";import{S as pe}from"./SectionTitle-DBY9oj05.js";import{s as de}from"./profileSelectors-DjL7l0TR.js";const me=K().shape({title:b().required("Title is required"),description:b().max(200,"Description must be at most 200 characters").required("Description is required"),category:b().required("Category is required"),area:b().required("Area is required"),instructions:b().max(200,"Instructions must be at most 200 characters").required("Instructions are required")}),ue="_container_1o5ms_1",he="_titleWrapper_1o5ms_19",_e="_titleAndCrumpsWraper_1o5ms_25",ge="_formWrapper_1o5ms_37",xe="_form_1o5ms_37",je="_nameInput_1o5ms_81",ye="_nameInputWrapper_1o5ms_109",be="_errorTitle_1o5ms_115",Ie="_errorMsg_1o5ms_133",fe="_textareaWrapper_1o5ms_171",Ne="_textarea_1o5ms_171",ve="_labelPrep_1o5ms_215",We="_symbolCounter_1o5ms_235",Te="_recipeData_1o5ms_249",Ae="_recipeIncstructions_1o5ms_261",Be="_buttonWrapper_1o5ms_269",Ce="_button_1o5ms_269",Se="_trashBtn_1o5ms_301",Me="_iconTrash_1o5ms_317",De="_categoryAndTime_1o5ms_381",s={container:ue,titleWrapper:he,titleAndCrumpsWraper:_e,formWrapper:ge,form:xe,nameInput:je,nameInputWrapper:ye,errorTitle:be,errorMsg:Ie,textareaWrapper:fe,textarea:Ne,labelPrep:ve,symbolCounter:We,recipeData:Te,recipeIncstructions:Ae,buttonWrapper:Be,button:Ce,trashBtn:Se,iconTrash:Me,categoryAndTime:De},Le="_errorMsg_1gh9h_9",$e="_wrapper_1gh9h_21",Re="_uploadBox_1gh9h_39",Ue="_uploadAnotherSpan_1gh9h_63",ke="_customUploadBtn_1gh9h_85",we="_imagePreview_1gh9h_109",Qe="_btnWrapper_1gh9h_129",qe="_photoIcon_1gh9h_203",u={errorMsg:Le,wrapper:$e,uploadBox:Re,uploadAnotherSpan:Ue,customUploadBtn:ke,imagePreview:we,btnWrapper:Qe,photoIcon:qe},Pe=({register:r,setValue:n,imagePreview:c,setImagePreview:p,errors:a,watch:l})=>(j.useEffect(()=>{const o=l(h=>{h.thumb[0]&&(p(URL.createObjectURL(h.thumb[0])),n("thumb",h.thumb[0]))});return()=>o.unsubscribe()},[l,p,n]),e.jsxs("div",{className:u.wrapper,children:[e.jsx("div",{className:u.uploadBox,children:e.jsxs("label",{className:u.customUploadBtn,children:[e.jsx(A,{type:"file",name:"thumb",register:r,setValue:n,errors:a}),c&&e.jsx("img",{src:c,alt:"Recipe Preview",className:u.imagePreview}),e.jsxs("div",{className:u.btnWrapper,children:[!c&&e.jsxs(e.Fragment,{children:[e.jsx(V,{iconId:"icon-capture-photo-camera",width:"50px",height:"50",customStyle:u.photoIcon}),e.jsx("span",{children:"Upload a photo"})]}),a.thumb&&e.jsx("p",{className:u.errorMsg,children:a.thumb.message})]})]})}),c&&e.jsxs("label",{className:u.uploadAnotherSpan,children:[e.jsx(A,{type:"file",name:"thumb",register:r,setValue:n,errors:a}),"Upload another photo"]})]})),Ee="_container_11pdu_1",Ge="_errorMsg_11pdu_13",Fe="_textareaWrapper_11pdu_25",He="_symbolCounter_11pdu_33",Je="_textarea_11pdu_25",Oe="_inputQuantity_11pdu_97",ze="_buttonAdd_11pdu_145",Ke="_addBtnIcon_11pdu_181",Ve="_icon_11pdu_207",Xe="_list_11pdu_231",Ye="_listItem_11pdu_243",Ze="_imageWrapper_11pdu_257",et="_image_11pdu_257",tt="_iconBtn_11pdu_273",st="_textWrapper_11pdu_305",nt="_ingredientAndQuantity_11pdu_315",t={container:Ee,errorMsg:Ge,textareaWrapper:Fe,symbolCounter:He,textarea:Je,inputQuantity:Oe,buttonAdd:ze,addBtnIcon:Ke,icon:Ve,list:Xe,listItem:Ye,imageWrapper:Ze,image:et,iconBtn:tt,textWrapper:st,ingredientAndQuantity:nt},rt="_iconBtn_sycip_1",at="_icon_sycip_1",it="_counterInput_sycip_41",T={iconBtn:rt,icon:at,counterInput:it},ot=({cookingTime:r,setCookingTime:n})=>{const c=()=>{n(a=>a+1)},p=()=>{n(a=>a>1?a-1:1)};return e.jsxs("div",{children:[e.jsx("label",{children:"Cooking Time"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx(B,{iconId:"icon-minus",width:"16",height:"16",type:"button",style:T.iconBtn,styleSVG:T.icon,onClick:p}),e.jsx("div",{children:e.jsxs("span",{style:{margin:"0 12px"},children:[r," min"]})}),e.jsx(B,{iconId:"icon-plus",type:"button",width:"16",height:"16",style:T.iconBtn,styleSVG:T.icon,onClick:c})]})]})},G=r=>{j.useEffect(()=>{const n=document.querySelector(`.${r}`),c=p=>{n.style.height="36px",n.style.height=`${p.target.scrollHeight}px`};return n.addEventListener("input",c),()=>{n.removeEventListener("input",c)}},[r])},ct=({register:r,setValue:n,watch:c,ingredients:p,selectedIngredients:a,setSelectedIngredients:l,errors:o,categories:h,areas:C,cookingTime:S,setCookingTime:M,isIngredientsLoading:D,isCategoriesLoading:L,isAreasLoading:$})=>{var W;const[R,y]=j.useState(!1),_=c("ingredient"),I=c("measure"),f=()=>{if(_&&I){const i=p.find(g=>g._id===_.value);l([...a,{id:_.value,measure:I,imageUrl:i.img,label:_.label}]),n("ingredient",null),n("measure",""),y(!0)}},N=i=>{l(a.filter((g,U)=>U!==i)),a.length<=1&&y(!1)},v=i=>i?e.jsx(X,{}):null;return G(t.textarea),e.jsxs("div",{className:t.container,children:[e.jsxs("div",{className:t.textareaWrapper,children:[e.jsx("textarea",{...r("description"),name:"description",maxLength:"200",placeholder:"Enter the description of the dish",className:t.textarea}),e.jsxs("span",{className:t.symbolCounter,children:[((W=c("description"))==null?void 0:W.length)||0,"/200"]}),o.description&&e.jsx("p",{className:t.errorMsg,children:o.description.message})]}),e.jsx("div",{className:t.categoryAndTime,children:v(L)||e.jsxs("div",{children:[e.jsx("label",{children:"Category"}),e.jsx(w,{options:h,placeholder:"Select a category",...r("category"),onChange:i=>n("category",i.label)}),o.category&&e.jsx("p",{className:t.errorMsg,children:o.category.message})]})}),e.jsx("div",{className:t.categoryAndTime,children:v($)||e.jsxs("div",{children:[e.jsx("label",{children:"Area"}),e.jsx(w,{options:C,placeholder:"Select area",...r("area"),onChange:i=>n("area",i.label)}),o.area&&e.jsx("p",{className:t.errorMsg,children:o.area.message})]})}),e.jsxs("div",{children:[e.jsx(ot,{cookingTime:S,setCookingTime:M}),o.cookingTime&&e.jsx("p",{className:t.errorMsg,children:o.cookingTime.message})]}),e.jsxs("div",{className:t.ingredientAndQuantity,children:[D?e.jsx("p",{children:"Loading..."}):e.jsxs("div",{children:[e.jsx("label",{children:"Ingredient"}),e.jsx(w,{options:p,placeholder:"Select an ingredient",className:t.select,...r("ingredient"),onChange:i=>n("ingredient",i)}),o.ingredient&&e.jsx("p",{className:t.errorMsg,children:o.ingredient.message})]}),e.jsxs("div",{children:[e.jsx(A,{type:"text",name:"measure",register:r,placeholder:"Enter quantity",classname:t.inputQuantity}),o.measure&&e.jsx("p",{className:t.errorMsg,children:o.measure.message})]})]}),R&&e.jsx("ul",{className:t.list,children:a.map((i,g)=>e.jsxs("li",{className:t.listItem,children:[e.jsx("div",{className:t.imageWrapper,children:e.jsx("img",{src:i.imageUrl,alt:i.label,width:"55px",height:"55px",className:t.image})}),e.jsxs("div",{className:t.textWrapper,children:[e.jsx("p",{children:i.label}),e.jsx("p",{children:i.measure})]}),e.jsx(B,{iconId:"icon-close-btn",type:"button",onClick:()=>N(g),style:t.iconBtn})]},g))}),e.jsx(E,{text:"Add ingredient",type:"button",onClick:f,iconId:"icon-plus",iconStyle:t.addBtnIcon,classname:t.buttonAdd})]})},lt="_formTitleWrapper_1hnv8_1",pt="_fromDescription_1hnv8_37",dt="_formTitle_1hnv8_1",P={formTitleWrapper:lt,fromDescription:pt,formTitle:dt},mt=()=>e.jsx("div",{className:P.formTitleWrapper,children:e.jsx("p",{className:P.fromDescription,children:"Reveal your culinary art, share your favorite recipe and create gastronomic masterpieces with us."})}),xt=()=>{var q;const{register:r,handleSubmit:n,control:c,setValue:p,watch:a,formState:{errors:l},reset:o}=Y({resolver:oe(me),defaultValues:{selectedIngredients:[]}}),{data:h,isLoading:C}=Z(),{data:S,isLoading:M}=ee(),{data:D,isLoading:L}=te(),{data:$}=se(),[R]=ne(),[y,_]=j.useState([]),[I,f]=j.useState(null),[N,v]=j.useState(1),W=re(de),i=ae(),g=h,U=S,F=D,H=ie(),k="toastId",J=async x=>{const d=new FormData;d.append("thumb",x.thumb),d.append("title",x.title),d.append("description",x.description),d.append("category",x.category),d.append("area",x.area),d.append("time",N.toString()),d.append("instructions",x.instructions);const z=y.map(m=>({id:m.id,measure:m.measure}));d.append("ingredients",JSON.stringify(z));try{const m=await R(d);m.error?Q.error(m.error.data.message,{toastId:k}):(i(ce([...W,m.data])),H(`/user/${$.id}`),Q.success("Sign In successful",{toastId:k}),o())}catch(m){Q.error(m.message,{toastId:k})}},O=()=>{o(),f(null),_([])};return G(s.textarea),e.jsxs("div",{className:s.container,children:[e.jsxs("div",{className:s.titleAndCrumpsWraper,children:[e.jsx(le,{currentPage:"Add Recipe"}),e.jsxs("div",{className:s.titleWrapper,children:[e.jsx(pe,{text:"add recipe"}),e.jsx(mt,{})]})]}),e.jsx("form",{onSubmit:n(J),className:s.form,children:e.jsxs("div",{className:s.formWrapper,children:[e.jsx(Pe,{register:r,setValue:p,imagePreview:I,setImagePreview:f,watch:a,errors:l}),e.jsxs("div",{children:[e.jsxs("div",{className:s.nameInputWrapper,children:[e.jsx(A,{type:"text",name:"title",register:r,placeholder:"The name of the recipe",classname:s.nameInput}),l.title&&e.jsx("p",{className:s.errorTitle,children:l.title.message})]}),e.jsx("div",{className:s.recipeData,children:e.jsx("div",{className:s.categoryAndTime,children:e.jsxs("div",{className:s.recipeData,children:[e.jsx(ct,{control:c,register:r,setValue:p,watch:a,categories:g,areas:F,cookingTime:N,setCookingTime:v,ingredients:U,selectedIngredients:y,setSelectedIngredients:_,errors:l,isCategoriesLoading:C,isIngredientsLoading:M,isAreasLoading:L}),l.selectedIngredients&&e.jsx("p",{className:s.errorMsg,children:l.selectedIngredients.message})]})})}),e.jsxs("div",{className:s.recipeIncstructions,children:[e.jsx("label",{className:s.labelPrep,children:"Recipe preparation"}),e.jsxs("div",{className:s.textareaWrapper,children:[e.jsx("textarea",{...r("instructions"),name:"instructions",placeholder:"Enter recipe",maxLength:"200",className:s.textarea}),e.jsxs("span",{className:s.symbolCounter,children:[((q=a("instructions"))==null?void 0:q.length)||0,"/200"]}),l.instructions&&e.jsx("p",{className:s.errorMsg,children:l.instructions.message})]})]}),e.jsxs("div",{className:s.buttonWrapper,children:[e.jsx(B,{iconId:"icon-trash",type:"button",onClick:O,width:"20",height:"20",style:s.trashBtn,styleSVG:s.iconTrash}),e.jsx(E,{text:"Publish",type:"submit",classname:s.button})]})]})]})})]})};export{xt as default};
