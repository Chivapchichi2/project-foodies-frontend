import{H as Z,J as W,r as b,j as e,K as w,I as ee,M,P as k,B as E,L as te,Q as se,T as re,U as ne,V as ae,W as ie,X as oe,k as ce,Y as le,l as de,Z as pe,_ as B,$ as ue}from"./index-C1suQ7XN.js";import{B as me}from"./BreadCrumbs-CL4shAXg.js";import{S as _e}from"./SectionTitle-BvWXJiqQ.js";import{s as he}from"./profileSelectors-DjL7l0TR.js";const ge=Z().shape({title:W().required("Title is required"),description:W().max(200,"Description must be at most 200 characters").required("Description is required"),category:W().required("Category is required"),area:W().required("Area is required"),instructions:W().max(2e3,"Description must be at most 200 characters").required("Instructions are required")}),xe="_container_1u45g_1",je="_subheadear_1u45g_19",be="_breaCrumbs_1u45g_33",fe="_titleWrapper_1u45g_41",ye="_titleAndCrumpsWraper_1u45g_49",Ie="_formWrapper_1u45g_65",Ne="_form_1u45g_65",ve="_nameInput_1u45g_109",We="_nameInputWrapper_1u45g_137",Ce="_errorTitle_1u45g_143",Te="_errorMsg_1u45g_161",$e="_textareaWrapper_1u45g_199",Ae="_textarea_1u45g_199",Be="_labelPrep_1u45g_243",Se="_symbolCounter_1u45g_263",we="_recipeData_1u45g_277",Me="_recipeIncstructions_1u45g_289",De="_buttonWrapper_1u45g_297",ze="_button_1u45g_297",Le="_trashBtn_1u45g_329",Re="_iconTrash_1u45g_345",qe="_categoryAndTime_1u45g_413",t={container:xe,subheadear:je,breaCrumbs:be,titleWrapper:fe,titleAndCrumpsWraper:ye,formWrapper:Ie,form:Ne,nameInput:ve,nameInputWrapper:We,errorTitle:Ce,errorMsg:Te,textareaWrapper:$e,textarea:Ae,labelPrep:Be,symbolCounter:Se,recipeData:we,recipeIncstructions:Me,buttonWrapper:De,button:ze,trashBtn:Le,iconTrash:Re,categoryAndTime:qe},Ue="_errorMsg_1gh9h_9",ke="_wrapper_1gh9h_21",Qe="_uploadBox_1gh9h_39",Ee="_uploadAnotherSpan_1gh9h_63",Pe="_customUploadBtn_1gh9h_85",Fe="_imagePreview_1gh9h_109",Ge="_btnWrapper_1gh9h_129",He="_photoIcon_1gh9h_203",g={errorMsg:Ue,wrapper:ke,uploadBox:Qe,uploadAnotherSpan:Ee,customUploadBtn:Pe,imagePreview:Fe,btnWrapper:Ge,photoIcon:He},Je=({register:n,setValue:r,imagePreview:c,setImagePreview:d,errors:i,watch:l})=>(b.useEffect(()=>{const o=l(x=>{x.thumb[0]&&(d(URL.createObjectURL(x.thumb[0])),r("thumb",x.thumb[0]))});return()=>o.unsubscribe()},[l,d,r]),e.jsxs("div",{className:g.wrapper,children:[e.jsx("div",{className:g.uploadBox,children:e.jsxs("label",{className:g.customUploadBtn,children:[e.jsx(w,{type:"file",name:"thumb",register:n,setValue:r,errors:i}),c&&e.jsx("img",{src:c,alt:"Recipe Preview",className:g.imagePreview}),e.jsxs("div",{className:g.btnWrapper,children:[!c&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{iconId:"icon-capture-photo-camera",width:"50px",height:"50",customStyle:g.photoIcon}),e.jsx("span",{children:"Upload a photo"})]}),i.thumb&&e.jsx("p",{className:g.errorMsg,children:i.thumb.message})]})]})}),c&&e.jsxs("label",{className:g.uploadAnotherSpan,children:[e.jsx(w,{type:"file",name:"thumb",register:n,setValue:r,errors:i}),"Upload another photo"]})]})),Oe="_container_zhuui_1",Ke="_errorMsg_zhuui_13",Ve="_selectors_time_wrapp_zhuui_25",Xe="_textareaWrapper_zhuui_37",Ye="_symbolCounter_zhuui_45",Ze="_textarea_zhuui_37",et="_inputQuantity_zhuui_109",tt="_buttonAdd_zhuui_157",st="_addBtnIcon_zhuui_193",rt="_icon_zhuui_219",nt="_list_zhuui_243",at="_listItem_zhuui_255",it="_imageWrapper_zhuui_269",ot="_image_zhuui_269",ct="_iconBtn_zhuui_285",lt="_textWrapper_zhuui_317",dt="_ingredientAndQuantity_zhuui_327",s={container:Oe,errorMsg:Ke,selectors_time_wrapp:Ve,textareaWrapper:Xe,symbolCounter:Ye,textarea:Ze,inputQuantity:et,buttonAdd:tt,addBtnIcon:st,icon:rt,list:nt,listItem:at,imageWrapper:it,image:ot,iconBtn:ct,textWrapper:lt,ingredientAndQuantity:dt},pt="_iconBtn_sycip_1",ut="_icon_sycip_1",mt="_counterInput_sycip_41",S={iconBtn:pt,icon:ut,counterInput:mt},_t=({cookingTime:n,setCookingTime:r})=>{const c=()=>{r(i=>i+10)},d=()=>{r(i=>i>10?i-10:10)};return e.jsxs("div",{children:[e.jsx("label",{children:"Cooking Time"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx(M,{iconId:"icon-minus",width:"16",height:"16",type:"button",style:S.iconBtn,styleSVG:S.icon,onClick:d}),e.jsx("div",{children:e.jsxs("span",{style:{margin:"0 12px"},children:[n," min"]})}),e.jsx(M,{iconId:"icon-plus",type:"button",width:"16",height:"16",style:S.iconBtn,styleSVG:S.icon,onClick:c})]})]})},ht="_form__group_1jccn_1",gt="_form__field_1jccn_15",xt="_form__label_1jccn_55",u={form__group:ht,form__field:gt,form__label:xt},P=n=>{b.useEffect(()=>{const r=document.querySelector(`.${n}`),c=d=>{r.style.height="36px",r.style.height=`${d.target.scrollHeight}px`};return r.addEventListener("input",c),()=>{r.removeEventListener("input",c)}},[n])},jt=({register:n,setValue:r,watch:c,ingredients:d,selectedIngredients:i,setSelectedIngredients:l,errors:o,categories:x,areas:C,cookingTime:j,setCookingTime:D,isIngredientsLoading:y,isCategoriesLoading:z,isAreasLoading:L})=>{var N;const[R,T]=b.useState(!1),f=c("ingredient"),$=c("measure"),q=()=>{if(f&&$){const a=d.find(h=>h._id===f.value);l([...i,{id:f.value,measure:$,imageUrl:a.img,label:f.label}]),r("ingredient",null),r("measure",""),T(!0)}},U=a=>{l(i.filter((h,A)=>A!==a)),i.length<=1&&T(!1)},I=a=>a?e.jsx(te,{}):null;return P(s.textarea),e.jsxs("div",{className:s.container,children:[e.jsxs("div",{className:`${u.form__group} ${u.field}`,children:[e.jsx("textarea",{...n("description"),name:"description",maxLength:"200",placeholder:"Enter the description of the dish",id:"description",className:`${u.form__field} ${s.textarea}`,required:!0}),e.jsx("label",{htmlFor:"description",className:u.form__label,children:"Enter the description of the dish"}),e.jsxs("span",{className:s.symbolCounter,children:[((N=c("description"))==null?void 0:N.length)||0,"/200"]})]}),o.description&&e.jsx("p",{className:s.errorMsg,children:o.description.message}),e.jsxs("div",{className:s.selectors_time_wrapp,children:[e.jsx("div",{className:s.categoryAndTime,children:I(z)||e.jsxs("div",{children:[e.jsx("label",{children:"Category"}),e.jsx(k,{options:x,placeholder:"Select a category",...n("category"),onChange:a=>r("category",a.label)}),o.category&&e.jsx("p",{className:s.errorMsg,children:o.category.message})]})}),e.jsxs("div",{children:[e.jsx(_t,{cookingTime:j,setCookingTime:D}),o.cookingTime&&e.jsx("p",{className:s.errorMsg,children:o.cookingTime.message})]})]}),e.jsx("div",{className:s.categoryAndTime,children:I(L)||e.jsxs("div",{children:[e.jsx("label",{children:"Area"}),e.jsx(k,{options:C,placeholder:"Select area",...n("area"),onChange:a=>r("area",a.label)}),o.area&&e.jsx("p",{className:s.errorMsg,children:o.area.message})]})}),e.jsxs("div",{className:s.ingredientAndQuantity,children:[y?e.jsx("p",{children:"Loading..."}):e.jsxs("div",{children:[e.jsx("label",{children:"Ingredient"}),e.jsx(k,{options:d,placeholder:"Select an ingredient",className:s.select,...n("ingredient"),onChange:a=>r("ingredient",a)}),o.ingredient&&e.jsx("p",{className:s.errorMsg,children:o.ingredient.message})]}),e.jsxs("div",{className:`${u.form__group} ${u.field}`,children:[e.jsx(w,{type:"text",name:"measure",id:"measure",register:n,placeholder:"Enter quantity",classname:`${s.inputQuantity} ${u.form__field}`}),e.jsx("label",{className:u.form__label,htmlFor:"measure",children:"Enter quantity"}),o.measure&&e.jsx("p",{className:s.errorMsg,children:o.measure.message})]})]}),R&&e.jsx("ul",{className:s.list,children:i.map((a,h)=>e.jsxs("li",{className:s.listItem,children:[e.jsx("div",{className:s.imageWrapper,children:e.jsx("img",{src:a.imageUrl,alt:a.label,width:"55px",height:"55px",className:s.image})}),e.jsxs("div",{className:s.textWrapper,children:[e.jsx("p",{children:a.label}),e.jsx("p",{children:a.measure})]}),e.jsx(M,{iconId:"icon-close-btn",type:"button",onClick:()=>U(h),style:s.iconBtn})]},h))}),e.jsx(E,{text:"Add ingredient",type:"button",onClick:q,iconId:"icon-plus",iconStyle:s.addBtnIcon,classname:s.buttonAdd})]})},bt="_formTitleWrapper_1hnv8_1",ft="_fromDescription_1hnv8_37",yt="_formTitle_1hnv8_1",Q={formTitleWrapper:bt,fromDescription:ft,formTitle:yt},It=()=>e.jsx("div",{className:Q.formTitleWrapper,children:e.jsx("p",{className:Q.fromDescription,children:"Reveal your culinary art, share your favorite recipe and create gastronomic masterpieces with us."})}),Tt=()=>{const{register:n,handleSubmit:r,control:c,setValue:d,watch:i,formState:{errors:l},reset:o}=se({resolver:pe(ge),defaultValues:{selectedIngredients:[]}}),[x,C]=b.useState(0),j=200,D=_=>{const v=_.target.value.trim().split(/\s+/).filter(p=>p.length>0);if(v.length<=j)C(v.length);else{const p=v.slice(0,j).join(" ");_.target.value=p,C(j),B.error(`max length ${j} words`)}},y="addRecipeToastId",{data:z,isLoading:L}=re(),{data:R,isLoading:T}=ne(),{data:f,isLoading:$}=ae(),{data:q}=ie(),[U]=oe(),[I,N]=b.useState([]),[a,h]=b.useState(null),[A,F]=b.useState(10),G=ce(he),H=le(),J=z,O=R,K=f,V=de(),X=async _=>{const m=new FormData;m.append("thumb",_.thumb),m.append("title",_.title),m.append("description",_.description),m.append("category",_.category),m.append("area",_.area),m.append("time",A.toString()),m.append("instructions",_.instructions);const v=I.map(p=>({id:p.id,measure:p.measure}));m.append("ingredients",JSON.stringify(v));try{const p=await U(m);p.error?B.error(p.error.data.message,{toastId:y}):(H(ue([...G,p.data])),V(`/user/${q.id}`),B.success("Recipe added",{toastId:y}),o())}catch(p){B.error(p.message,{toastId:y})}},Y=()=>{o(),h(null),N([])};return P(t.textarea),e.jsxs("div",{className:t.container,children:[e.jsxs("div",{className:t.titleAndCrumpsWraper,children:[e.jsx("div",{className:t.breaCrumbs,children:e.jsx(me,{currentPage:"Add Recipe"})}),e.jsxs("div",{className:t.titleWrapper,children:[e.jsx(_e,{text:"add recipe"}),e.jsx(It,{})]})]}),e.jsx("form",{onSubmit:r(X),className:t.form,children:e.jsxs("div",{className:t.formWrapper,children:[e.jsx(Je,{register:n,setValue:d,imagePreview:a,setImagePreview:h,watch:i,errors:l}),e.jsxs("div",{children:[e.jsxs("div",{className:t.nameInputWrapper,children:[e.jsx(w,{type:"text",name:"title",register:n,placeholder:"The name of the recipe",classname:t.nameInput}),l.title&&e.jsx("p",{className:t.errorTitle,children:l.title.message})]}),e.jsx("div",{className:t.recipeData,children:e.jsx("div",{className:t.categoryAndTime,children:e.jsxs("div",{className:t.recipeData,children:[e.jsx(jt,{control:c,register:n,setValue:d,watch:i,categories:J,areas:K,cookingTime:A,setCookingTime:F,ingredients:O,selectedIngredients:I,setSelectedIngredients:N,errors:l,isCategoriesLoading:L,isIngredientsLoading:T,isAreasLoading:$}),l.selectedIngredients&&e.jsx("p",{className:t.errorMsg,children:l.selectedIngredients.message})]})})}),e.jsxs("div",{className:t.recipeIncstructions,children:[e.jsx("h2",{className:t.subheadear,children:"Recipe preparation"}),e.jsxs("div",{className:`${t.textareaWrapper} ${u.form__group} ${u.field}`,children:[e.jsx("textarea",{...n("instructions"),onInput:D,id:"instructions",name:"instructions",placeholder:"Enter recipe",maxLength:"none",className:`${t.textarea} ${u.form__field}`}),e.jsx("label",{className:`${t.labelPrep} ${u.form__label}`,children:"Enter recipe"}),e.jsxs("span",{className:t.symbolCounter,children:[x,"/",j]}),l.instructions&&e.jsx("p",{className:t.errorMsg,children:l.instructions.message})]})]}),e.jsxs("div",{className:t.buttonWrapper,children:[e.jsx(M,{iconId:"icon-trash",type:"button",onClick:Y,width:"20",height:"20",style:t.trashBtn,styleSVG:t.iconTrash}),e.jsx(E,{text:"Publish",type:"submit",classname:t.button})]})]})]})})]})};export{Tt as default};
