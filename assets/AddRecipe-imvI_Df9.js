import{H as ee,J as W,r as x,j as e,K as M,I as te,M as D,P as E,B as F,L as se,Q as re,T as ne,U as ae,V as ie,k as Q,W as oe,X as ce,Y as le,l as de,Z as pe,_ as B,$ as me}from"./index-BDvgBgoP.js";import{B as ue}from"./BreadCrumbs-BlvCaYof.js";import{S as _e}from"./SectionTitle-3Dm-vTkP.js";import{s as he}from"./profileSelectors-DjL7l0TR.js";const ge=ee().shape({title:W().required("Title is required"),description:W().max(200,"Description must be at most 200 characters").required("Description is required"),category:W().required("Category is required"),area:W().required("Area is required"),instructions:W().max(2e3,"Description must be at most 200 characters").required("Instructions are required")}),xe="_container_1u45g_1",je="_subheadear_1u45g_19",be="_breaCrumbs_1u45g_33",fe="_titleWrapper_1u45g_41",ye="_titleAndCrumpsWraper_1u45g_49",Ie="_formWrapper_1u45g_65",Ne="_form_1u45g_65",ve="_nameInput_1u45g_109",We="_nameInputWrapper_1u45g_137",Ce="_errorTitle_1u45g_143",Te="_errorMsg_1u45g_161",$e="_textareaWrapper_1u45g_199",Se="_textarea_1u45g_199",Ae="_labelPrep_1u45g_243",Be="_symbolCounter_1u45g_263",we="_recipeData_1u45g_277",Me="_recipeIncstructions_1u45g_289",De="_buttonWrapper_1u45g_297",Le="_button_1u45g_297",Re="_trashBtn_1u45g_329",qe="_iconTrash_1u45g_345",ke="_categoryAndTime_1u45g_413",t={container:xe,subheadear:je,breaCrumbs:be,titleWrapper:fe,titleAndCrumpsWraper:ye,formWrapper:Ie,form:Ne,nameInput:ve,nameInputWrapper:We,errorTitle:Ce,errorMsg:Te,textareaWrapper:$e,textarea:Se,labelPrep:Ae,symbolCounter:Be,recipeData:we,recipeIncstructions:Me,buttonWrapper:De,button:Le,trashBtn:Re,iconTrash:qe,categoryAndTime:ke},Ue="_errorMsg_1gh9h_9",Ee="_wrapper_1gh9h_21",Qe="_uploadBox_1gh9h_39",Pe="_uploadAnotherSpan_1gh9h_63",Fe="_customUploadBtn_1gh9h_85",Ge="_imagePreview_1gh9h_109",He="_btnWrapper_1gh9h_129",Je="_photoIcon_1gh9h_203",g={errorMsg:Ue,wrapper:Ee,uploadBox:Qe,uploadAnotherSpan:Pe,customUploadBtn:Fe,imagePreview:Ge,btnWrapper:He,photoIcon:Je},Oe=({register:n,setValue:r,imagePreview:c,setImagePreview:d,errors:i,watch:l})=>(x.useEffect(()=>{const o=l(j=>{j.thumb[0]&&(d(URL.createObjectURL(j.thumb[0])),r("thumb",j.thumb[0]))});return()=>o.unsubscribe()},[l,d,r]),e.jsxs("div",{className:g.wrapper,children:[e.jsx("div",{className:g.uploadBox,children:e.jsxs("label",{className:g.customUploadBtn,children:[e.jsx(M,{type:"file",name:"thumb",register:n,setValue:r,errors:i}),c&&e.jsx("img",{src:c,alt:"Recipe Preview",className:g.imagePreview}),e.jsxs("div",{className:g.btnWrapper,children:[!c&&e.jsxs(e.Fragment,{children:[e.jsx(te,{iconId:"icon-capture-photo-camera",width:"50px",height:"50",customStyle:g.photoIcon}),e.jsx("span",{children:"Upload a photo"})]}),i.thumb&&e.jsx("p",{className:g.errorMsg,children:i.thumb.message})]})]})}),c&&e.jsxs("label",{className:g.uploadAnotherSpan,children:[e.jsx(M,{type:"file",name:"thumb",register:n,setValue:r,errors:i}),"Upload another photo"]})]})),ze="_container_h0edc_1",Ke="_errorMsg_h0edc_13",Ve="_selectors_time_wrapp_h0edc_25",Xe="_textareaWrapper_h0edc_37",Ye="_symbolCounter_h0edc_45",Ze="_textarea_h0edc_37",et="_inputQuantity_h0edc_109",tt="_buttonAdd_h0edc_157",st="_addBtnIcon_h0edc_193",rt="_icon_h0edc_219",nt="_list_h0edc_243",at="_listItem_h0edc_255",it="_imageWrapper_h0edc_269",ot="_image_h0edc_269",ct="_iconBtn_h0edc_285",lt="_textWrapper_h0edc_317",dt="_ingredientAndQuantity_h0edc_327",s={container:ze,errorMsg:Ke,selectors_time_wrapp:Ve,textareaWrapper:Xe,symbolCounter:Ye,textarea:Ze,inputQuantity:et,buttonAdd:tt,addBtnIcon:st,icon:rt,list:nt,listItem:at,imageWrapper:it,image:ot,iconBtn:ct,textWrapper:lt,ingredientAndQuantity:dt},pt="_iconBtn_sycip_1",mt="_icon_sycip_1",ut="_counterInput_sycip_41",w={iconBtn:pt,icon:mt,counterInput:ut},_t=({cookingTime:n,setCookingTime:r})=>{const c=()=>{r(i=>i+10)},d=()=>{r(i=>i>10?i-10:10)};return e.jsxs("div",{children:[e.jsx("label",{children:"Cooking Time"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx(D,{iconId:"icon-minus",width:"16",height:"16",type:"button",style:w.iconBtn,styleSVG:w.icon,onClick:d}),e.jsx("div",{children:e.jsxs("span",{style:{margin:"0 12px"},children:[n," min"]})}),e.jsx(D,{iconId:"icon-plus",type:"button",width:"16",height:"16",style:w.iconBtn,styleSVG:w.icon,onClick:c})]})]})},ht="_form__group_1jccn_1",gt="_form__field_1jccn_15",xt="_form__label_1jccn_55",m={form__group:ht,form__field:gt,form__label:xt},G=n=>{x.useEffect(()=>{const r=document.querySelector(`.${n}`),c=d=>{r.style.height="36px",r.style.height=`${d.target.scrollHeight}px`};return r.addEventListener("input",c),()=>{r.removeEventListener("input",c)}},[n])},jt=({register:n,setValue:r,watch:c,ingredients:d,selectedIngredients:i,setSelectedIngredients:l,errors:o,categories:j,areas:C,cookingTime:b,setCookingTime:L,isIngredientsLoading:y,isCategoriesLoading:R,isAreasLoading:q})=>{var N;const[k,T]=x.useState(!1),f=c("ingredient"),$=c("measure"),S=()=>{if(f&&$){const a=d.find(h=>h._id===f.value);l([...i,{id:f.value,measure:$,imageUrl:a.img,label:f.label}]),r("ingredient",null),r("measure",""),T(!0)}},U=a=>{l(i.filter((h,A)=>A!==a)),i.length<=1&&T(!1)},I=a=>a?e.jsx(se,{}):null;return G(s.textarea),e.jsxs("div",{className:s.container,children:[e.jsxs("div",{className:`${m.form__group} ${m.field}`,children:[e.jsx("textarea",{...n("description"),name:"description",maxLength:"200",placeholder:"Enter the description of the dish",id:"description",className:`${m.form__field} ${s.textarea}`,required:!0}),e.jsx("label",{htmlFor:"description",className:m.form__label,children:"Enter the description of the dish"}),e.jsxs("span",{className:s.symbolCounter,children:[((N=c("description"))==null?void 0:N.length)||0,"/200"]})]}),o.description&&e.jsx("p",{className:s.errorMsg,children:o.description.message}),e.jsxs("div",{className:s.selectors_time_wrapp,children:[e.jsx("div",{className:s.categoryAndTime,children:I(R)||e.jsxs("div",{children:[e.jsx("label",{children:"Category"}),e.jsx(E,{options:j,placeholder:"Select a category",...n("category"),onChange:a=>r("category",a.label)}),o.category&&e.jsx("p",{className:s.errorMsg,children:o.category.message})]})}),e.jsxs("div",{children:[e.jsx(_t,{cookingTime:b,setCookingTime:L}),o.cookingTime&&e.jsx("p",{className:s.errorMsg,children:o.cookingTime.message})]})]}),e.jsx("div",{className:s.categoryAndTime,children:I(q)||e.jsxs("div",{children:[e.jsx("label",{children:"Area"}),e.jsx(E,{options:C,placeholder:"Select area",...n("area"),onChange:a=>r("area",a.label)}),o.area&&e.jsx("p",{className:s.errorMsg,children:o.area.message})]})}),e.jsxs("div",{className:s.ingredientAndQuantity,children:[y?e.jsx("p",{children:"Loading..."}):e.jsxs("div",{children:[e.jsx("label",{children:"Ingredient"}),e.jsx(E,{options:d,placeholder:"Select an ingredient",className:s.select,...n("ingredient"),onChange:a=>r("ingredient",a)}),o.ingredient&&e.jsx("p",{className:s.errorMsg,children:o.ingredient.message})]}),e.jsxs("div",{className:`${m.form__group} ${m.field}`,children:[e.jsx(M,{type:"text",name:"measure",id:"measure",register:n,placeholder:"Enter quantity",classname:`${s.inputQuantity} ${m.form__field}`}),e.jsx("label",{className:m.form__label,htmlFor:"measure",children:"Enter quantity"}),o.measure&&e.jsx("p",{className:s.errorMsg,children:o.measure.message})]})]}),k&&e.jsx("ul",{className:s.list,children:i.map((a,h)=>e.jsxs("li",{className:s.listItem,children:[e.jsx("div",{className:s.imageWrapper,children:e.jsx("img",{src:a.imageUrl,alt:a.label,width:"55px",height:"55px",className:s.image})}),e.jsxs("div",{className:s.textWrapper,children:[e.jsx("p",{children:a.label}),e.jsx("p",{children:a.measure})]}),e.jsx(D,{iconId:"icon-close-btn",type:"button",onClick:()=>U(h),style:s.iconBtn})]},h))}),e.jsx(F,{text:"Add ingredient",type:"button",onClick:S,iconId:"icon-plus",iconStyle:s.addBtnIcon,classname:s.buttonAdd})]})},bt="_formTitleWrapper_1hnv8_1",ft="_fromDescription_1hnv8_37",yt="_formTitle_1hnv8_1",P={formTitleWrapper:bt,fromDescription:ft,formTitle:yt},It=()=>e.jsx("div",{className:P.formTitleWrapper,children:e.jsx("p",{className:P.fromDescription,children:"Reveal your culinary art, share your favorite recipe and create gastronomic masterpieces with us."})}),Tt=()=>{const{register:n,handleSubmit:r,control:c,setValue:d,watch:i,formState:{errors:l},reset:o}=re({resolver:pe(ge),defaultValues:{selectedIngredients:[]}}),[j,C]=x.useState(0),b=200,L=_=>{const v=_.target.value.trim().split(/\s+/).filter(p=>p.length>0);if(v.length<=b)C(v.length);else{const p=v.slice(0,b).join(" ");_.target.value=p,C(b),B.error(`max length ${b} words`)}},y="addRecipeToastId",{data:R,isLoading:q}=ne(),{data:k,isLoading:T}=ae(),{data:f,isLoading:$}=ie(),[S]=x.useState(Q(oe));console.log(S);const[U]=ce(),[I,N]=x.useState([]),[a,h]=x.useState(null),[A,H]=x.useState(10),J=Q(he),O=le(),z=R,K=k,V=f,X=de(),Y=async _=>{const u=new FormData;u.append("thumb",_.thumb),u.append("title",_.title),u.append("description",_.description),u.append("category",_.category),u.append("area",_.area),u.append("time",A.toString()),u.append("instructions",_.instructions);const v=I.map(p=>({id:p.id,measure:p.measure}));u.append("ingredients",JSON.stringify(v));try{const p=await U(u);p.error?B.error(p.error.data.message,{toastId:y}):(O(me([...J,p.data])),X(`/user/${S}`),B.success("Recipe added",{toastId:y}),o())}catch(p){B.error(p.message,{toastId:y})}},Z=()=>{o(),h(null),N([])};return G(t.textarea),e.jsxs("div",{className:t.container,children:[e.jsxs("div",{className:t.titleAndCrumpsWraper,children:[e.jsx("div",{className:t.breaCrumbs,children:e.jsx(ue,{currentPage:"Add Recipe"})}),e.jsxs("div",{className:t.titleWrapper,children:[e.jsx(_e,{text:"add recipe"}),e.jsx(It,{})]})]}),e.jsx("form",{onSubmit:r(Y),className:t.form,children:e.jsxs("div",{className:t.formWrapper,children:[e.jsx(Oe,{register:n,setValue:d,imagePreview:a,setImagePreview:h,watch:i,errors:l}),e.jsxs("div",{children:[e.jsxs("div",{className:t.nameInputWrapper,children:[e.jsx(M,{type:"text",name:"title",register:n,placeholder:"The name of the recipe",classname:t.nameInput}),l.title&&e.jsx("p",{className:t.errorTitle,children:l.title.message})]}),e.jsx("div",{className:t.recipeData,children:e.jsx("div",{className:t.categoryAndTime,children:e.jsxs("div",{className:t.recipeData,children:[e.jsx(jt,{control:c,register:n,setValue:d,watch:i,categories:z,areas:V,cookingTime:A,setCookingTime:H,ingredients:K,selectedIngredients:I,setSelectedIngredients:N,errors:l,isCategoriesLoading:q,isIngredientsLoading:T,isAreasLoading:$}),l.selectedIngredients&&e.jsx("p",{className:t.errorMsg,children:l.selectedIngredients.message})]})})}),e.jsxs("div",{className:t.recipeIncstructions,children:[e.jsx("h2",{className:t.subheadear,children:"Recipe preparation"}),e.jsxs("div",{className:`${t.textareaWrapper} ${m.form__group} ${m.field}`,children:[e.jsx("textarea",{...n("instructions"),onInput:L,id:"instructions",name:"instructions",placeholder:"Enter recipe",maxLength:"none",className:`${t.textarea} ${m.form__field}`}),e.jsx("label",{className:`${t.labelPrep} ${m.form__label}`,children:"Enter recipe"}),e.jsxs("span",{className:t.symbolCounter,children:[j,"/",b]}),l.instructions&&e.jsx("p",{className:t.errorMsg,children:l.instructions.message})]})]}),e.jsxs("div",{className:t.buttonWrapper,children:[e.jsx(D,{iconId:"icon-trash",type:"button",onClick:Z,width:"20",height:"20",style:t.trashBtn,styleSVG:t.iconTrash}),e.jsx(F,{text:"Publish",type:"submit",classname:t.button})]})]})]})})]})};export{Tt as default};
