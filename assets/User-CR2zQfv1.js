import{j as e,Y as E,k as m,x as q,z as ce,a0 as le,N as H,M as A,$ as J,a1 as pe,A as de,u as Q,B as z,F as X,r as d,a2 as ue,a3 as fe,a4 as _e,a5 as me,a6 as D,a7 as he,L as ge,a8 as xe,a9 as we,w as G,v as ve,aa as je,ab as be,ac as Ce,W as ye,ad as Ne,ae as Fe,af as Pe,_ as U,C as Ie,ag as Le,ah as Y}from"./index-C1suQ7XN.js";import{s as Z,a as B,b as K,c as Re,d as Ue}from"./profileSelectors-DjL7l0TR.js";import{S as We}from"./SectionTitle-BvWXJiqQ.js";import{B as Se}from"./BreadCrumbs-CL4shAXg.js";const Te="_container_1nv0s_1",Ae="_content_1nv0s_13",Ee="_message_1nv0s_21",y={container:Te,content:Ae,message:Ee},Be="_menuContainer_gij54_1",Oe="_menuItem_gij54_29",ke="_active_gij54_75",k={menuContainer:Be,menuItem:Oe,active:ke},$e=({menuItems:s,activeTab:o,setActiveTab:t})=>e.jsx("div",{className:k.menuContainer,children:s.map(a=>e.jsx("div",{className:`${k.menuItem} ${a.id===o?k.active:""}`,onClick:()=>t(a.id),children:a.label},a.id))}),Me="_recipeCard_zbyhy_1",ze={recipeCard:Me},ee=({imgUrl:s,title:o})=>e.jsx("div",{className:ze.recipeCard,children:e.jsx("img",{src:s,alt:o})}),De="_recipeCardWrapper_avu2p_1",Ve="_flexPhotoWrapper_avu2p_11",Qe="_recipeTextWrapper_avu2p_21",Ge="_recipeInstructions_avu2p_29",Ye="_recipeTitle_avu2p_51",qe="_buttonWrapper_avu2p_67",He="_recipeCardList_avu2p_77",Je="_iconBtn_avu2p_89",Xe="_icon_avu2p_89",v={recipeCardWrapper:De,flexPhotoWrapper:Ve,recipeTextWrapper:Qe,recipeInstructions:Ge,recipeTitle:Ye,buttonWrapper:qe,recipeCardList:He,iconBtn:Je,icon:Xe},Ze=({data:s,tab:o})=>{const t=E(),a=m(q),c=m(Z),p=m(B),[u]=ce(),[l]=le(),n=()=>{o==="recipe"?(t(J(c.filter(f=>f._id!==s._id))),l(s._id)):(t(pe(a.filter(f=>f!==s._id))),de(u,s._id,"delete"))};return e.jsxs("li",{className:v.recipeCardWrapper,children:[e.jsxs("div",{className:v.flexPhotoWrapper,children:[e.jsx(ee,{imgUrl:s.thumb,title:s.title}),e.jsxs("div",{className:v.recipeTextWrapper,children:[e.jsxs("h5",{className:v.recipeTitle,children:[" ",s.title," "]}),e.jsx("p",{className:v.recipeInstructions,children:s.instructions})]})]}),e.jsxs("div",{className:v.buttonWrapper,children:[e.jsx(H,{to:`/recipe/${s._id}`,children:e.jsx(A,{iconId:"icon-arrow-up-right",style:v.iconBtn,styleSVG:v.icon})}),p&&e.jsx(A,{iconId:"icon-trash",onClick:n,style:v.iconBtn,styleSVG:v.icon})]})]})},$=({data:s,tab:o})=>e.jsx("ul",{className:v.recipeCardList,children:s.map(t=>e.jsx(Ze,{data:t,tab:o},t._id))}),Ke="_cardWrapper_bt2lx_1",es="_photoWrapper_bt2lx_15",ss="_smallProfilePhoto_bt2lx_41",ts="_followerData_bt2lx_51",rs="_name_bt2lx_61",os="_descr_bt2lx_77",as="_followerCardList_bt2lx_91",is="_iconBtn_bt2lx_99",ns="_icon_bt2lx_99",cs="_recipesList_bt2lx_157",ls="_recipeCard_bt2lx_167",j={cardWrapper:Ke,photoWrapper:es,smallProfilePhoto:ss,followerData:ts,name:rs,descr:os,followerCardList:as,iconBtn:is,icon:ns,recipesList:cs,recipeCard:ls},ps=({data:s,tab:o,handleFollowUser:t,handleUnfollowUser:a})=>{var l;const c=Q(768,!1,3),p=Q(1440,3,4),u=()=>{if(o==="followers")return s.isFollowing?"unfollow":"follow";if(o==="following")return"unfollow"};return e.jsxs("li",{className:j.cardWrapper,children:[e.jsxs("div",{className:j.followerData,children:[e.jsx("div",{className:j.photoWrapper,children:e.jsx("img",{src:s.avatarURL||"https://gravatar.com/avatar/000000000000000000000000000000000000000000000000000000?d=mp",className:j.smallProfilePhoto,alt:"User avatar"})}),e.jsxs("div",{children:[e.jsxs("h5",{className:j.name,children:[" ",s.name]}),e.jsxs("p",{className:j.descr,children:["Own recipes: ",s.totalRecipes]}),e.jsx(z,{text:u(),variant:"follow_user",onClick:()=>u()==="follow"?t(s._id):a(s._id)})]})]}),c&&e.jsx("ul",{className:j.recipesList,children:(l=s==null?void 0:s.recipes)==null?void 0:l.map((n,f)=>{if(f<p)return e.jsx("li",{children:e.jsx(ee,{imgUrl:n.thumb,title:n.title})},n._id)})}),e.jsx(H,{to:`/user/${s._id}`,children:e.jsx(A,{iconId:"icon-arrow-up-right",style:j.iconBtn,styleSVG:j.icon})})]})},M=({data:s,tab:o,handleFollowUser:t,handleUnfollowUser:a})=>e.jsx("ul",{className:j.followerCardList,children:s.map(c=>e.jsx(ps,{data:c,tab:o,handleFollowUser:t,handleUnfollowUser:a},c._id))}),N=[{id:"my-recipes",label:"MY RECIPES",message:"Nothing has been added to your recipes list yet. Please browse our recipes and add your favorites for easy access in the future."},{id:"my-favorites",label:"MY FAVORITES",message:"Nothing has been added to your favorite recipes list yet. Please browse our recipes and add your favorites for easy access in the future."},{id:"followers",label:"FOLLOWERS",message:"There are currently no followers on your account. Please engage our visitors with interesting content and draw their attention to your profile."},{id:"following",label:"FOLLOWING",message:"Your account currently has no subscriptions to other users. Learn more about our users and select those whose content interests you."}],W=[{id:"recipes",label:"RECIPES",message:"The current user hasn't added any recipes yet."},{id:"followers",label:"FOLLOWERS",message:"The current user hasn't any followers yet."}],ds=({handleFollowUser:s,handleUnfollowUser:o})=>{const{id:t}=X(),a=E(),c=m(B),p=m(K),u=m(Re),l=d.useRef(null),n=m(Z),f=m(q),[h,_]=d.useState(1),[F,i]=d.useState(0),[r,g]=d.useState(c?N[0].id:W[0].id),{data:x,isLoading:P}=ue({userId:t,page:h},{skip:r!=="my-recipes"&&r!=="recipes"});d.useEffect(()=>{_(1)},[r]);const b=({selected:L})=>{_(L+1),l.current&&l.current.scrollIntoView({behavior:"smooth"})};d.useEffect(()=>{g(c?N[0].id:W[0].id)},[c]);const{data:w,isLoading:se}=fe({page:h,limit:10,skip:r!=="my-favorites"}),{data:S,isLoading:te}=_e({userId:t,page:h,skip:r!=="followers"}),{data:T,isLoading:re}=me({skip:r!=="following",page:h}),oe=P||se||te||re;d.useEffect(()=>{x&&!P&&(i(x.totalPages),a(J(x.data))),r==="followers"&&S?(i(S.totalPages),a(D(S.followersWithRecipes))):r==="following"&&T?(i(T.totalPages),a(he(T.followingWithRecipes))):r==="my-favorites"&&w&&i(w.totalPages)},[r,a,S,T,w,P,x,h,f]);const I=(L,O)=>L.find(({id:ne})=>ne===O).message,ae=()=>{var L;if(c)switch(r){case"my-recipes":return(n==null?void 0:n.length)>0?e.jsx($,{data:n,tab:"recipe"}):e.jsx("p",{className:y.message,children:I(N,r)});case"my-favorites":if(((L=w.data)==null?void 0:L.length)>0){const O=w==null?void 0:w.data.map(V=>V.recipe);return e.jsx($,{data:O,tab:"favorites"})}else return e.jsx("p",{className:y.message,children:I(N,r)});case"followers":return(p==null?void 0:p.length)>0?e.jsx(M,{handleFollowUser:s,handleUnfollowUser:o,data:p,tab:"followers"}):e.jsx("p",{className:y.message,children:I(N,r)});case"following":return(u==null?void 0:u.length)>0?e.jsx(M,{handleFollowUser:s,handleUnfollowUser:o,data:u,tab:"following"}):e.jsx("p",{className:y.message,children:I(N,r)});default:return null}else switch(r){case"recipes":return(x==null?void 0:x.total)>0?e.jsx($,{data:x.data}):e.jsx("p",{className:y.message,children:I(W,r)});case"followers":return(p==null?void 0:p.length)>0?e.jsx(M,{handleFollowUser:s,handleUnfollowUser:o,data:p,tab:"followers"}):e.jsx("p",{className:y.message,children:I(W,r)});default:return null}},ie=c?N:W;return e.jsxs("div",{className:y.container,ref:l,children:[e.jsx($e,{menuItems:ie,activeTab:r,setActiveTab:g}),oe?e.jsx(ge,{}):e.jsx("div",{className:y.content,children:ae()}),F>1&&e.jsx(xe,{pageCount:F,onPageChange:b,currentPage:h})]})},us="_container_1ivx6_1",fs="_breadscrumbs_1ivx6_9",_s="_title_1ivx6_17",ms="_subtitle_1ivx6_23",hs="_userInfoAndBtnWrapper_1ivx6_41",gs="_userInfoAndTabContentWerapper_1ivx6_111",R={container:us,breadscrumbs:fs,title:_s,subtitle:ms,userInfoAndBtnWrapper:hs,userInfoAndTabContentWerapper:gs},xs="_profile_card_wrapper_1iacj_1",ws="_profile_card_1iacj_1",vs="_profile_name_1iacj_43",js="_profile_card_info_1iacj_61",bs="_profile_info_item_1iacj_75",Cs="_profile_info_content_1iacj_95",ys="_profile_big_card_button_1iacj_111",Ns="_profile_big_card_icon_1iacj_129",Fs="_profile_photo_1iacj_137",C={profile_card_wrapper:xs,profile_card:ws,profile_name:vs,profile_card_info:js,profile_info_item:bs,profile_info_content:Cs,profile_big_card_button:ys,profile_big_card_icon:Ns,profile_photo:Fs},Ps=s=>s.charAt(0).toUpperCase()+s.slice(1),Is=({name:s,value:o})=>{const t={email:"email",createdRecipesCount:"added recipes",favoriteRecipesCount:"favorites",followersCount:"followers",followingCount:"following"};return e.jsxs("li",{className:C.profile_info_item,children:[Ps(t[s]),":",e.jsx("span",{className:C.profile_info_content,children:o})]})},Ls=()=>{const s=m(B),[o]=we(),t=m(Ue),a=E(),c=t?Object.keys(t):[],[p,u]=d.useState((t==null?void 0:t.avatar)||G),l=async i=>{const r=new FormData;r.append("avatar",i);try{const g=await o(r).unwrap();u(g.avatarURL),a(je(g.avatarURL))}catch(g){console.error("Error updating avatar:",g)}},n=i=>{const r=i.target.files[0];if(r){const g=new FileReader;g.onload=()=>{l(r)},g.readAsDataURL(r)}},f=d.useRef(null),[h,_]=d.useState({width:16,height:16}),F=()=>{f.current.click()};return d.useEffect(()=>{u((t==null?void 0:t.avatar)||G)},[t==null?void 0:t.avatar]),d.useEffect(()=>{const i=()=>{window.matchMedia("(max-width: 768px)").matches?_({width:16,height:16}):_({width:18,height:18})};return i(),window.addEventListener("resize",i),()=>{window.removeEventListener("resize",i)}},[]),e.jsx("div",{className:C.profile_card_wrapper,children:e.jsxs("div",{className:C.profile_card,children:[e.jsx("img",{className:C.profile_photo,src:p,alt:`${(t==null?void 0:t.name)||"User Name"} avatar`}),s&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"file",ref:f,style:{display:"none"},onChange:n}),e.jsx(A,{iconId:"icon-plus",style:C.profile_big_card_button,styleSVG:C.profile_big_card_icon,stroke:"#FFF",width:h.width,height:h.height,onClick:F})]}),e.jsx("h3",{className:C.profile_name,children:t==null?void 0:t.name}),e.jsx("ul",{className:C.profile_info,children:c.map(i=>{if(!(i==="_id"||i==="name"||i==="avatar"))return e.jsx(Is,{name:i,value:t[i]},ve())})})]})})},Rs="toastId",As=()=>{const s=m(be),[o,t]=d.useState(!1),[a,c]=d.useState(!1),p=m(B),u=m(K),{id:l}=X(),n=E(),{data:f,error:h}=Ce(l),{data:_}=ye(),[F,{error:i}]=Ne(),[r,{error:g}]=Fe(),x=b=>{if(F(b),i){U.error("Something went wrong",{position:"top-right"});return}n(Y({..._,following:[..._.following,b]})),n(D([...u])),c(!0),U.success("Follow successful",{position:"top-right"})},P=b=>{if(r(b),g){U.error("Something went wrong",{position:"top-right"});return}n(Y({..._,following:_.following.filter(w=>w!==b)})),n(D([...u])),c(!1),U.success("Unfollow successful",{position:"top-right"})};if(d.useEffect(()=>{if(l!==s&&_&&_.following){const b=_.following.some(w=>w===l);c(b)}},[_,l,s]),d.useEffect(()=>{f&&n(Pe(f))},[f,n]),h){U.error(h.data.message,{position:"top-right",toastId:Rs});return}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:R.container,children:[e.jsx("div",{className:R.breadscrumbs,children:e.jsx(Se,{currentPage:"Profile"})}),e.jsx("div",{className:R.title,children:e.jsx(We,{text:"Profile"})}),e.jsxs("p",{className:R.subtitle,children:["Reveal your culinary art, share your favorite recipe and create ",e.jsx("br",{}),"gastronomic masterpieces with us."]}),e.jsxs("div",{className:R.userInfoAndTabContentWerapper,children:[e.jsxs("div",{className:R.userInfoAndBtnWrapper,children:[e.jsx(Ls,{}),p?e.jsx(z,{type:"button",variant:"logoutOrFollowBtn",text:"Log Out",onClick:()=>t(!0)}):e.jsx(z,{type:"button",variant:"logoutOrFollowBtn",text:a?"Unfollow":"Follow",onClick:a?()=>P(l):()=>x(l)})]}),e.jsx(ds,{handleFollowUser:x,handleUnfollowUser:P})]})]}),e.jsx(Ie,{isOpen:o,onClose:()=>t(!1),children:e.jsx(Le,{setModalLogOutOpen:t})})]})};export{As as default};
