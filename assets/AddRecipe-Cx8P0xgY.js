import{H as Z,J as W,r as j,j as e,K as w,I as ee,M,P as k,B as E,L as te,Q as se,T as re,U as ne,V as ae,W as ie,X as oe,k as ce,Y as le,l as de,Z as pe,_ as B,$ as me}from"./index-D1B0M72U.js";import{B as ue}from"./BreadCrumbs-BkC7MaJE.js";import{S as _e}from"./SectionTitle-C7wQrdzk.js";import{s as he}from"./profileSelectors-DjL7l0TR.js";const ge=Z().shape({title:W().required("Title is required"),description:W().max(200,"Description must be at most 200 characters").required("Description is required"),category:W().required("Category is required"),area:W().required("Area is required"),instructions:W().max(2e3,"Description must be at most 200 characters").required("Instructions are required")}),xe="_container_1efs7_1",fe="_breaCrumbs_1efs7_19",je="_titleWrapper_1efs7_27",be="_titleAndCrumpsWraper_1efs7_35",ye="_formWrapper_1efs7_51",Ie="_form_1efs7_51",Ne="_nameInput_1efs7_95",ve="_nameInputWrapper_1efs7_123",We="_errorTitle_1efs7_129",Ce="_errorMsg_1efs7_147",Te="_textareaWrapper_1efs7_185",$e="_textarea_1efs7_185",Ae="_labelPrep_1efs7_229",Be="_symbolCounter_1efs7_249",Se="_recipeData_1efs7_263",we="_recipeIncstructions_1efs7_275",Me="_buttonWrapper_1efs7_283",De="_button_1efs7_283",ze="_trashBtn_1efs7_315",Le="_iconTrash_1efs7_331",Re="_categoryAndTime_1efs7_393",t={container:xe,breaCrumbs:fe,titleWrapper:je,titleAndCrumpsWraper:be,formWrapper:ye,form:Ie,nameInput:Ne,nameInputWrapper:ve,errorTitle:We,errorMsg:Ce,textareaWrapper:Te,textarea:$e,labelPrep:Ae,symbolCounter:Be,recipeData:Se,recipeIncstructions:we,buttonWrapper:Me,button:De,trashBtn:ze,iconTrash:Le,categoryAndTime:Re},qe="_errorMsg_1gh9h_9",Ue="_wrapper_1gh9h_21",ke="_uploadBox_1gh9h_39",Qe="_uploadAnotherSpan_1gh9h_63",Ee="_customUploadBtn_1gh9h_85",Pe="_imagePreview_1gh9h_109",Fe="_btnWrapper_1gh9h_129",Ge="_photoIcon_1gh9h_203",g={errorMsg:qe,wrapper:Ue,uploadBox:ke,uploadAnotherSpan:Qe,customUploadBtn:Ee,imagePreview:Pe,btnWrapper:Fe,photoIcon:Ge},He=({register:n,setValue:r,imagePreview:c,setImagePreview:d,errors:i,watch:l})=>(j.useEffect(()=>{const o=l(x=>{x.thumb[0]&&(d(URL.createObjectURL(x.thumb[0])),r("thumb",x.thumb[0]))});return()=>o.unsubscribe()},[l,d,r]),e.jsxs("div",{className:g.wrapper,children:[e.jsx("div",{className:g.uploadBox,children:e.jsxs("label",{className:g.customUploadBtn,children:[e.jsx(w,{type:"file",name:"thumb",register:n,setValue:r,errors:i}),c&&e.jsx("img",{src:c,alt:"Recipe Preview",className:g.imagePreview}),e.jsxs("div",{className:g.btnWrapper,children:[!c&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{iconId:"icon-capture-photo-camera",width:"50px",height:"50",customStyle:g.photoIcon}),e.jsx("span",{children:"Upload a photo"})]}),i.thumb&&e.jsx("p",{className:g.errorMsg,children:i.thumb.message})]})]})}),c&&e.jsxs("label",{className:g.uploadAnotherSpan,children:[e.jsx(w,{type:"file",name:"thumb",register:n,setValue:r,errors:i}),"Upload another photo"]})]})),Je="_container_zhuui_1",Oe="_errorMsg_zhuui_13",Ke="_selectors_time_wrapp_zhuui_25",Ve="_textareaWrapper_zhuui_37",Xe="_symbolCounter_zhuui_45",Ye="_textarea_zhuui_37",Ze="_inputQuantity_zhuui_109",et="_buttonAdd_zhuui_157",tt="_addBtnIcon_zhuui_193",st="_icon_zhuui_219",rt="_list_zhuui_243",nt="_listItem_zhuui_255",at="_imageWrapper_zhuui_269",it="_image_zhuui_269",ot="_iconBtn_zhuui_285",ct="_textWrapper_zhuui_317",lt="_ingredientAndQuantity_zhuui_327",s={container:Je,errorMsg:Oe,selectors_time_wrapp:Ke,textareaWrapper:Ve,symbolCounter:Xe,textarea:Ye,inputQuantity:Ze,buttonAdd:et,addBtnIcon:tt,icon:st,list:rt,listItem:nt,imageWrapper:at,image:it,iconBtn:ot,textWrapper:ct,ingredientAndQuantity:lt},dt="_iconBtn_sycip_1",pt="_icon_sycip_1",mt="_counterInput_sycip_41",S={iconBtn:dt,icon:pt,counterInput:mt},ut=({cookingTime:n,setCookingTime:r})=>{const c=()=>{r(i=>i+10)},d=()=>{r(i=>i>10?i-10:10)};return e.jsxs("div",{children:[e.jsx("label",{children:"Cooking Time"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx(M,{iconId:"icon-minus",width:"16",height:"16",type:"button",style:S.iconBtn,styleSVG:S.icon,onClick:d}),e.jsx("div",{children:e.jsxs("span",{style:{margin:"0 12px"},children:[n," min"]})}),e.jsx(M,{iconId:"icon-plus",type:"button",width:"16",height:"16",style:S.iconBtn,styleSVG:S.icon,onClick:c})]})]})},_t="_form__group_1jccn_1",ht="_form__field_1jccn_15",gt="_form__label_1jccn_55",m={form__group:_t,form__field:ht,form__label:gt},P=n=>{j.useEffect(()=>{const r=document.querySelector(`.${n}`),c=d=>{r.style.height="36px",r.style.height=`${d.target.scrollHeight}px`};return r.addEventListener("input",c),()=>{r.removeEventListener("input",c)}},[n])},xt=({register:n,setValue:r,watch:c,ingredients:d,selectedIngredients:i,setSelectedIngredients:l,errors:o,categories:x,areas:C,cookingTime:f,setCookingTime:D,isIngredientsLoading:y,isCategoriesLoading:z,isAreasLoading:L})=>{var N;const[R,T]=j.useState(!1),b=c("ingredient"),$=c("measure"),q=()=>{if(b&&$){const a=d.find(h=>h._id===b.value);l([...i,{id:b.value,measure:$,imageUrl:a.img,label:b.label}]),r("ingredient",null),r("measure",""),T(!0)}},U=a=>{l(i.filter((h,A)=>A!==a)),i.length<=1&&T(!1)},I=a=>a?e.jsx(te,{}):null;return P(s.textarea),e.jsxs("div",{className:s.container,children:[e.jsxs("div",{className:`${m.form__group} ${m.field}`,children:[e.jsx("textarea",{...n("description"),name:"description",maxLength:"200",placeholder:"Enter the description of the dish",id:"description",className:`${m.form__field} ${s.textarea}`,required:!0}),e.jsx("label",{htmlFor:"description",className:m.form__label,children:"Enter the description of the dish"}),e.jsxs("span",{className:s.symbolCounter,children:[((N=c("description"))==null?void 0:N.length)||0,"/200"]})]}),o.description&&e.jsx("p",{className:s.errorMsg,children:o.description.message}),e.jsxs("div",{className:s.selectors_time_wrapp,children:[e.jsx("div",{className:s.categoryAndTime,children:I(z)||e.jsxs("div",{children:[e.jsx("label",{children:"Category"}),e.jsx(k,{options:x,placeholder:"Select a category",...n("category"),onChange:a=>r("category",a.label)}),o.category&&e.jsx("p",{className:s.errorMsg,children:o.category.message})]})}),e.jsxs("div",{children:[e.jsx(ut,{cookingTime:f,setCookingTime:D}),o.cookingTime&&e.jsx("p",{className:s.errorMsg,children:o.cookingTime.message})]})]}),e.jsx("div",{className:s.categoryAndTime,children:I(L)||e.jsxs("div",{children:[e.jsx("label",{children:"Area"}),e.jsx(k,{options:C,placeholder:"Select area",...n("area"),onChange:a=>r("area",a.label)}),o.area&&e.jsx("p",{className:s.errorMsg,children:o.area.message})]})}),e.jsxs("div",{className:s.ingredientAndQuantity,children:[y?e.jsx("p",{children:"Loading..."}):e.jsxs("div",{children:[e.jsx("label",{children:"Ingredient"}),e.jsx(k,{options:d,placeholder:"Select an ingredient",className:s.select,...n("ingredient"),onChange:a=>r("ingredient",a)}),o.ingredient&&e.jsx("p",{className:s.errorMsg,children:o.ingredient.message})]}),e.jsxs("div",{className:`${m.form__group} ${m.field}`,children:[e.jsx(w,{type:"text",name:"measure",id:"measure",register:n,placeholder:"Enter quantity",classname:`${s.inputQuantity} ${m.form__field}`}),e.jsx("label",{className:m.form__label,htmlFor:"measure",children:"Enter quantity"}),o.measure&&e.jsx("p",{className:s.errorMsg,children:o.measure.message})]})]}),R&&e.jsx("ul",{className:s.list,children:i.map((a,h)=>e.jsxs("li",{className:s.listItem,children:[e.jsx("div",{className:s.imageWrapper,children:e.jsx("img",{src:a.imageUrl,alt:a.label,width:"55px",height:"55px",className:s.image})}),e.jsxs("div",{className:s.textWrapper,children:[e.jsx("p",{children:a.label}),e.jsx("p",{children:a.measure})]}),e.jsx(M,{iconId:"icon-close-btn",type:"button",onClick:()=>U(h),style:s.iconBtn})]},h))}),e.jsx(E,{text:"Add ingredient",type:"button",onClick:q,iconId:"icon-plus",iconStyle:s.addBtnIcon,classname:s.buttonAdd})]})},ft="_formTitleWrapper_1hnv8_1",jt="_fromDescription_1hnv8_37",bt="_formTitle_1hnv8_1",Q={formTitleWrapper:ft,fromDescription:jt,formTitle:bt},yt=()=>e.jsx("div",{className:Q.formTitleWrapper,children:e.jsx("p",{className:Q.fromDescription,children:"Reveal your culinary art, share your favorite recipe and create gastronomic masterpieces with us."})}),Ct=()=>{const{register:n,handleSubmit:r,control:c,setValue:d,watch:i,formState:{errors:l},reset:o}=se({resolver:pe(ge),defaultValues:{selectedIngredients:[]}}),[x,C]=j.useState(0),f=200,D=_=>{const v=_.target.value.trim().split(/\s+/).filter(p=>p.length>0);if(v.length<=f)C(v.length);else{const p=v.slice(0,f).join(" ");_.target.value=p,C(f),B.error(`max length ${f} words`)}},y="addRecipeToastId",{data:z,isLoading:L}=re(),{data:R,isLoading:T}=ne(),{data:b,isLoading:$}=ae(),{data:q}=ie(),[U]=oe(),[I,N]=j.useState([]),[a,h]=j.useState(null),[A,F]=j.useState(10),G=ce(he),H=le(),J=z,O=R,K=b,V=de(),X=async _=>{const u=new FormData;u.append("thumb",_.thumb),u.append("title",_.title),u.append("description",_.description),u.append("category",_.category),u.append("area",_.area),u.append("time",A.toString()),u.append("instructions",_.instructions);const v=I.map(p=>({id:p.id,measure:p.measure}));u.append("ingredients",JSON.stringify(v));try{const p=await U(u);p.error?B.error(p.error.data.message,{toastId:y}):(H(me([...G,p.data])),V(`/user/${q.id}`),B.success("Recipe added",{toastId:y}),o())}catch(p){B.error(p.message,{toastId:y})}},Y=()=>{o(),h(null),N([])};return P(t.textarea),e.jsxs("div",{className:t.container,children:[e.jsxs("div",{className:t.titleAndCrumpsWraper,children:[e.jsx("div",{className:t.breaCrumbs,children:e.jsx(ue,{currentPage:"Add Recipe"})}),e.jsxs("div",{className:t.titleWrapper,children:[e.jsx(_e,{text:"add recipe"}),e.jsx(yt,{})]})]}),e.jsx("form",{onSubmit:r(X),className:t.form,children:e.jsxs("div",{className:t.formWrapper,children:[e.jsx(He,{register:n,setValue:d,imagePreview:a,setImagePreview:h,watch:i,errors:l}),e.jsxs("div",{children:[e.jsxs("div",{className:t.nameInputWrapper,children:[e.jsx(w,{type:"text",name:"title",register:n,placeholder:"The name of the recipe",classname:t.nameInput}),l.title&&e.jsx("p",{className:t.errorTitle,children:l.title.message})]}),e.jsx("div",{className:t.recipeData,children:e.jsx("div",{className:t.categoryAndTime,children:e.jsxs("div",{className:t.recipeData,children:[e.jsx(xt,{control:c,register:n,setValue:d,watch:i,categories:J,areas:K,cookingTime:A,setCookingTime:F,ingredients:O,selectedIngredients:I,setSelectedIngredients:N,errors:l,isCategoriesLoading:L,isIngredientsLoading:T,isAreasLoading:$}),l.selectedIngredients&&e.jsx("p",{className:t.errorMsg,children:l.selectedIngredients.message})]})})}),e.jsx("div",{className:t.recipeIncstructions,children:e.jsxs("div",{className:`${t.textareaWrapper} ${m.form__group} ${m.field}`,children:[e.jsx("textarea",{...n("instructions"),onInput:D,id:"instructions",name:"instructions",placeholder:"Enter recipe",maxLength:"none",className:`${t.textarea} ${m.form__field}`}),e.jsx("label",{className:`${t.labelPrep} ${m.form__label}`,children:"Recipe preparation"}),e.jsxs("span",{className:t.symbolCounter,children:[x,"/",f," words"]}),l.instructions&&e.jsx("p",{className:t.errorMsg,children:l.instructions.message})]})}),e.jsxs("div",{className:t.buttonWrapper,children:[e.jsx(M,{iconId:"icon-trash",type:"button",onClick:Y,width:"20",height:"20",style:t.trashBtn,styleSVG:t.iconTrash}),e.jsx(E,{text:"Publish",type:"submit",classname:t.button})]})]})]})})]})};export{Ct as default};
