import{j as e,Y as E,k as h,x as H,z as le,a0 as pe,N as J,M as k,$ as X,a1 as de,A as ue,u as G,a2 as Z,B as V,F as K,r as u,a3 as _e,a4 as fe,a5 as me,a6 as he,a7 as ge,a8 as we,L as je,a9 as xe,aa as ve,w as Y,v as be,ab as Ce,ac as ye,W as Ie,ad as Ne,ae as Fe,af as $,ag as Le,_ as U,C as Pe,ah as Re}from"./index-CRscMHQT.js";import{s as ee,a as B,b as Ue,c as We,d as Se}from"./profileSelectors-DjL7l0TR.js";import{r as Te}from"./recipe_without_img-BDzgIXng.js";import{S as Ae}from"./SectionTitle-CRBejGdg.js";import{B as ke}from"./BreadCrumbs-DTQxr3o8.js";const Ee="_container_ghk6w_1",Be="_content_ghk6w_11",Oe="_message_ghk6w_19",b={container:Ee,content:Be,message:Oe},$e="_menuContainer_gij54_1",Me="_menuItem_gij54_29",De="_active_gij54_75",M={menuContainer:$e,menuItem:Me,active:De},ze=({menuItems:s,activeTab:a,setActiveTab:t})=>e.jsx("div",{className:M.menuContainer,children:s.map(i=>e.jsx("div",{className:`${M.menuItem} ${i.id===a?M.active:""}`,onClick:()=>t(i.id),children:i.label},i.id))}),Ve="_recipeCard_8rx53_1",Qe="_recipeImg_8rx53_17",q={recipeCard:Ve,recipeImg:Qe},se=({imgUrl:s,title:a})=>e.jsx("div",{className:q.recipeCard,children:e.jsx("img",{className:q.recipeImg,src:s!=="[object FileList]"?s:Te,alt:a})}),Ge="_recipeCardWrapper_1osv5_1",Ye="_flexPhotoWrapper_1osv5_11",qe="_recipeTextWrapper_1osv5_21",He="_recipeInstructions_1osv5_29",Je="_recipeTitle_1osv5_51",Xe="_buttonWrapper_1osv5_63",Ze="_recipeCardList_1osv5_73",Ke="_iconBtn_1osv5_85",es="_icon_1osv5_85",j={recipeCardWrapper:Ge,flexPhotoWrapper:Ye,recipeTextWrapper:qe,recipeInstructions:He,recipeTitle:Je,buttonWrapper:Xe,recipeCardList:Ze,iconBtn:Ke,icon:es},ss=({data:s,tab:a})=>{const t=E(),i=h(H),l=h(ee),p=h(B),[c]=le(),[d]=pe(),_=()=>{a==="recipe"?(t(X(l.filter(f=>f._id!==s._id))),d(s._id)):(t(de(i.filter(f=>f!==s._id))),ue(c,s._id,"delete"))};return e.jsxs("li",{className:j.recipeCardWrapper,children:[e.jsxs("div",{className:j.flexPhotoWrapper,children:[e.jsx(se,{imgUrl:s.thumb,title:s.title}),e.jsxs("div",{className:j.recipeTextWrapper,children:[e.jsxs("h5",{className:j.recipeTitle,children:[" ",s.title," "]}),e.jsx("p",{className:j.recipeInstructions,children:s.instructions})]})]}),e.jsxs("div",{className:j.buttonWrapper,children:[e.jsx(J,{to:`/recipe/${s._id}`,children:e.jsx(k,{iconId:"icon-arrow-up-right",style:j.iconBtn,styleSVG:j.icon})}),p&&e.jsx(k,{iconId:"icon-trash",onClick:_,style:j.iconBtn,styleSVG:j.icon})]})]})},D=({data:s,tab:a})=>e.jsx("ul",{className:j.recipeCardList,children:s.map(t=>e.jsx(ss,{data:t,tab:a},t._id))}),ts="_cardWrapper_1ul5j_1",rs="_photoWrapper_1ul5j_15",os="_smallProfilePhoto_1ul5j_41",as="_followerData_1ul5j_53",is="_name_1ul5j_65",ns="_descr_1ul5j_81",cs="_followerCardList_1ul5j_95",ls="_iconBtn_1ul5j_103",ps="_icon_1ul5j_103",ds="_recipesList_1ul5j_171",us="_recipeCard_1ul5j_185",_s="_link_wrapper_1ul5j_219",x={cardWrapper:ts,photoWrapper:rs,smallProfilePhoto:os,followerData:as,name:is,descr:ns,followerCardList:cs,iconBtn:ls,icon:ps,recipesList:ds,recipeCard:us,link_wrapper:_s},fs=({data:s,tab:a,handleFollowUser:t,handleUnfollowUser:i})=>{var _;const l=G(768,!1,3),p=G(1440,3,4),c=h(Z),d=()=>{if(a==="followers")return s.isFollowing?"unfollow":"follow";if(a==="following")return"unfollow"};return e.jsxs("li",{className:x.cardWrapper,children:[e.jsxs("div",{className:x.followerData,children:[e.jsx("img",{src:s.avatarURL||"https://gravatar.com/avatar/000000000000000000000000000000000000000000000000000000?d=mp",className:x.smallProfilePhoto,alt:"User avatar"}),e.jsxs("div",{children:[e.jsxs("h5",{className:x.name,children:[" ",s.name.split(" ")[0]]}),e.jsxs("p",{className:x.descr,children:["Own recipes: ",s.totalRecipes]}),e.jsx(V,{disabled:s._id===c,text:d(),variant:"follow_user",onClick:()=>d()==="follow"?t(s._id):i(s._id)})]})]}),l&&e.jsx("ul",{className:x.recipesList,children:(_=s==null?void 0:s.recipes)==null?void 0:_.map((f,o)=>{if(o<p)return e.jsx("li",{children:e.jsx(se,{imgUrl:f.thumb,title:f.title})},f._id)})}),e.jsx(J,{to:`/user/${s._id}`,className:x.link_wrapper,children:e.jsx(k,{iconId:"icon-arrow-up-right",style:x.iconBtn,styleSVG:x.icon})})]})},z=({data:s,tab:a,handleFollowUser:t,handleUnfollowUser:i})=>e.jsx("ul",{className:x.followerCardList,children:s.map(l=>e.jsx(fs,{data:l,tab:a,handleFollowUser:t,handleUnfollowUser:i},l._id))}),I=[{id:"my-recipes",label:"MY RECIPES",message:"Nothing has been added to your recipes list yet. Please browse our recipes and add your favorites for easy access in the future."},{id:"my-favorites",label:"MY FAVORITES",message:"Nothing has been added to your favorite recipes list yet. Please browse our recipes and add your favorites for easy access in the future."},{id:"followers",label:"FOLLOWERS",message:"There are currently no followers on your account. Please engage our visitors with interesting content and draw their attention to your profile."},{id:"following",label:"FOLLOWING",message:"Your account currently has no subscriptions to other users. Learn more about our users and select those whose content interests you."}],W=[{id:"recipes",label:"RECIPES",message:"The current user hasn't added any recipes yet."},{id:"followers",label:"FOLLOWERS",message:"The current user hasn't any followers yet."}],ms=({handleFollowUser:s,handleUnfollowUser:a})=>{const{id:t}=K(),i=E(),l=h(B),p=h(Ue),c=h(We),d=u.useRef(null),_=h(ee),f=h(H),[o,C]=u.useState(1),[N,n]=u.useState(0),[r,m]=u.useState(l?I[0].id:W[0].id),{data:g,isLoading:w}=_e({userId:t,page:o},{skip:r!=="my-recipes"&&r!=="recipes"});u.useEffect(()=>{C(1)},[r]);const R=({selected:L})=>{C(L+1),d.current&&d.current.scrollIntoView({behavior:"smooth"})};u.useEffect(()=>{m(l?I[0].id:W[0].id)},[l]);const{data:y,isLoading:te}=fe({page:o,limit:10,skip:r!=="my-favorites"}),{data:T,isLoading:re}=me({userId:t,page:o,skip:r!=="followers"}),{data:A,isLoading:oe}=he({skip:r!=="following",page:o}),ae=w||te||re||oe;u.useEffect(()=>{g&&!w&&(n(g.totalPages),i(X(g.data))),r==="followers"&&T?(n(T.totalPages),i(ge(T.followersWithRecipes))):r==="following"&&A?(n(A.totalPages),i(we(A.followingWithRecipes))):r==="my-favorites"&&y&&n(y.totalPages)},[r,i,T,A,y,w,g,o,f]);const F=(L,O)=>L.find(({id:ce})=>ce===O).message,ie=()=>{var L;if(l)switch(r){case"my-recipes":return(_==null?void 0:_.length)>0?e.jsx(D,{data:_,tab:"recipe"}):e.jsx("p",{className:b.message,children:F(I,r)});case"my-favorites":if(((L=y.data)==null?void 0:L.length)>0){const O=y==null?void 0:y.data.map(Q=>Q.recipe);return e.jsx(D,{data:O,tab:"favorites"})}else return e.jsx("p",{className:b.message,children:F(I,r)});case"followers":return(p==null?void 0:p.length)>0?e.jsx(z,{handleFollowUser:s,handleUnfollowUser:a,data:p,tab:"followers"}):e.jsx("p",{className:b.message,children:F(I,r)});case"following":return(c==null?void 0:c.length)>0?e.jsx(z,{handleFollowUser:s,handleUnfollowUser:a,data:c,tab:"following"}):e.jsx("p",{className:b.message,children:F(I,r)});default:return null}else switch(r){case"recipes":return(g==null?void 0:g.total)>0?e.jsx(D,{data:g.data}):e.jsx("p",{className:b.message,children:F(W,r)});case"followers":return(p==null?void 0:p.length)>0?e.jsx(z,{handleFollowUser:s,handleUnfollowUser:a,data:p,tab:"followers"}):e.jsx("p",{className:b.message,children:F(W,r)});default:return null}},ne=l?I:W;return e.jsxs("div",{className:b.container,ref:d,children:[e.jsx(ze,{menuItems:ne,activeTab:r,setActiveTab:m}),ae?e.jsx(je,{}):e.jsx("div",{className:b.content,children:ie()}),N>1&&e.jsx(xe,{pageCount:N,onPageChange:R,currentPage:o})]})},hs="_container_8w65a_1",gs="_breadscrumbs_8w65a_9",ws="_title_8w65a_17",js="_subtitle_8w65a_23",xs="_userInfoAndBtnWrapper_8w65a_41",vs="_userInfoAndTabContentWerapper_8w65a_115",P={container:hs,breadscrumbs:gs,title:ws,subtitle:js,userInfoAndBtnWrapper:xs,userInfoAndTabContentWerapper:vs},bs="_profile_card_wrapper_1iacj_1",Cs="_profile_card_1iacj_1",ys="_profile_name_1iacj_43",Is="_profile_card_info_1iacj_61",Ns="_profile_info_item_1iacj_75",Fs="_profile_info_content_1iacj_95",Ls="_profile_big_card_button_1iacj_111",Ps="_profile_big_card_icon_1iacj_129",Rs="_profile_photo_1iacj_137",v={profile_card_wrapper:bs,profile_card:Cs,profile_name:ys,profile_card_info:Is,profile_info_item:Ns,profile_info_content:Fs,profile_big_card_button:Ls,profile_big_card_icon:Ps,profile_photo:Rs},Us=s=>s.charAt(0).toUpperCase()+s.slice(1),Ws=({name:s,value:a})=>{const t={email:"email",createdRecipesCount:"added recipes",favoriteRecipesCount:"favorites",followersCount:"followers",followingCount:"following"};return e.jsxs("li",{className:v.profile_info_item,children:[Us(t[s]),":",e.jsx("span",{className:v.profile_info_content,children:a})]})},Ss=()=>{const s=h(B),[a]=ve(),t=h(Se),i=E(),l=t?Object.keys(t):[],[p,c]=u.useState((t==null?void 0:t.avatar)||Y),d=async n=>{const r=new FormData;r.append("avatar",n);try{const m=await a(r).unwrap();c(m.avatarURL),i(Ce(m.avatarURL))}catch(m){console.error("Error updating avatar:",m)}},_=n=>{const r=n.target.files[0];if(r){const m=new FileReader;m.onload=()=>{d(r)},m.readAsDataURL(r)}},f=u.useRef(null),[o,C]=u.useState({width:16,height:16}),N=()=>{f.current.click()};return u.useEffect(()=>{c((t==null?void 0:t.avatar)||Y)},[t==null?void 0:t.avatar]),u.useEffect(()=>{const n=()=>{window.matchMedia("(max-width: 768px)").matches?C({width:16,height:16}):C({width:18,height:18})};return n(),window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}},[]),e.jsx("div",{className:v.profile_card_wrapper,children:e.jsxs("div",{className:v.profile_card,children:[e.jsx("img",{className:v.profile_photo,src:p,alt:`${(t==null?void 0:t.name)||"User Name"} avatar`}),s&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"file",ref:f,style:{display:"none"},onChange:_}),e.jsx(k,{iconId:"icon-plus",style:v.profile_big_card_button,styleSVG:v.profile_big_card_icon,stroke:"#FFF",width:o.width,height:o.height,onClick:N})]}),e.jsx("h3",{className:v.profile_name,children:t==null?void 0:t.name}),e.jsx("ul",{className:v.profile_info,children:l.map(n=>{if(!(n==="_id"||n==="name"||n==="avatar"))return e.jsx(Ws,{name:n,value:t[n]},be())})})]})})},S="toastId",Os=()=>{const s=h(Z),[a,t]=u.useState(!1),[i,l]=u.useState(!1),p=h(B),{id:c}=K(),d=E(),{data:_,error:f}=ye(c),{data:o}=Ie(),[C,{error:N}]=Ne(),[n,{error:r}]=Fe(),m=w=>{if(C(w),N){U.error("Something went wrong",{toastId:S});return}d($({...o,following:[...o.following,w]})),U.success("Follow successful",{toastId:S})},g=w=>{if(n(w),r){U.error("Something went wrong",{toastId:S});return}d($({...o,following:o.following.filter(R=>R!==w)})),U.success("Unfollow successful",{toastId:S})};if(u.useEffect(()=>{if(c!==s&&o&&o.following){const w=o.following.some(R=>R===c);l(w)}},[o,c,s]),u.useEffect(()=>{o&&d($(o)),_&&d(Le(_))},[_,o,d]),f){U.error(f.data.message,{toastId:S});return}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:P.container,children:[e.jsx("div",{className:P.breadscrumbs,children:e.jsx(ke,{currentPage:"Profile"})}),e.jsx("div",{className:P.title,children:e.jsx(Ae,{text:"Profile"})}),e.jsxs("p",{className:P.subtitle,children:["Reveal your culinary art, share your favorite recipe and create ",e.jsx("br",{}),"gastronomic masterpieces with us."]}),e.jsxs("div",{className:P.userInfoAndTabContentWerapper,children:[e.jsxs("div",{className:P.userInfoAndBtnWrapper,children:[e.jsx(Ss,{}),p?e.jsx(V,{type:"button",variant:"logoutOrFollowBtn",text:"Log Out",onClick:()=>t(!0)}):e.jsx(V,{type:"button",variant:"logoutOrFollowBtn",text:i?"Unfollow":"Follow",onClick:i?()=>g(c):()=>m(c)})]}),e.jsx(ms,{handleFollowUser:m,handleUnfollowUser:g})]})]}),e.jsx(Pe,{isOpen:a,onClose:()=>t(!1),children:e.jsx(Re,{setModalLogOutOpen:t})})]})};export{Os as default};
