import{G as O,r as y,j as e,H as Q,I as q,F as W,B as $,J,K as M,p as H,q as K,M as V,N as z,k as X,O as Y}from"./index-_J0qRqtA.js";import{S as w}from"./SelectShared-Df6f0TLZ.js";import{B as Z}from"./BreadCrumbs-CFHeAMco.js";import{S as ee}from"./SectionTitle-iIGH-wk9.js";const te=O().shape({}),ne="_container_1rfyo_1",se="_titleWrapper_1rfyo_15",ae="_form_1rfyo_23",ie="_nameInput_1rfyo_55",re="_textareaWrapper_1rfyo_85",oe="_textarea_1rfyo_85",ce="_labelPrep_1rfyo_121",le="_symbolCounter_1rfyo_141",pe="_recipeData_1rfyo_155",de="_recipeIncstructions_1rfyo_167",me="_buttonWrapper_1rfyo_175",ue="_button_1rfyo_175",he="_trashBtn_1rfyo_207",_e="_iconTrash_1rfyo_223",xe="_categoryAndTime_1rfyo_287",ge="_formWrapper_1rfyo_325",n={container:ne,titleWrapper:se,form:ae,nameInput:ie,textareaWrapper:re,textarea:oe,labelPrep:ce,symbolCounter:le,recipeData:pe,recipeIncstructions:de,buttonWrapper:me,button:ue,trashBtn:he,iconTrash:_e,categoryAndTime:xe,formWrapper:ge},ye="_wrapper_13bp0_7",je="_uploadBox_13bp0_23",fe="_uplodAnotherSpan_13bp0_45",be="_customUploadBtn_13bp0_59",ve="_imagePreview_13bp0_83",Ie="_btnWrapper_13bp0_103",Ne="_photoIcon_13bp0_165",_={wrapper:ye,uploadBox:je,uplodAnotherSpan:fe,customUploadBtn:be,imagePreview:ve,btnWrapper:Ie,photoIcon:Ne},We=({register:r,setValue:o,imagePreview:c,setImagePreview:p,errors:t,watch:l})=>(y.useEffect(()=>{const s=l(m=>{m.thumb[0]&&p(URL.createObjectURL(m.thumb[0]))&&o("image",m.thumb[0])});return()=>s.unsubscribe()},[l,p,o]),e.jsxs("div",{className:_.wrapper,children:[e.jsx("div",{className:_.uploadBox,children:e.jsxs("label",{className:_.customUploadBtn,children:[e.jsx(Q,{type:"file",name:"thumb",register:r,setValue:o,errors:t}),t.thumb&&e.jsx("p",{children:t.thumb.message}),c&&e.jsx("img",{src:c,alt:"Recipe Preview",className:_.imagePreview}),!c&&e.jsxs("div",{className:_.btnWrapper,children:[e.jsx(q,{iconId:"icon-capture-photo-camera",width:"50px",height:"50",customStyle:_.photoIcon}),e.jsx("span",{children:"Upload a photo"})]})]})}),c&&e.jsx("span",{className:_.uplodAnotherSpan,children:"Upload another photo"})]})),Se="_container_o41f0_1",Ce="_textareaWrapper_o41f0_13",Te="_symbolCounter_o41f0_21",Be="_textarea_o41f0_13",Ae="_inputQuantity_o41f0_77",De="_buttonAdd_o41f0_111",Le="_icon_o41f0_149",ke="_list_o41f0_173",we="_listItem_o41f0_185",Qe="_imageWrapper_o41f0_199",Ue="_image_o41f0_199",Re="_iconBtn_o41f0_215",$e="_textWrapper_o41f0_247",Pe="_ingredientAndQuantity_o41f0_257",i={container:Se,textareaWrapper:Ce,symbolCounter:Te,textarea:Be,inputQuantity:Ae,buttonAdd:De,icon:Le,list:ke,listItem:we,imageWrapper:Qe,image:Ue,iconBtn:Re,textWrapper:$e,ingredientAndQuantity:Pe},Ee="_iconBtn_sycip_1",Ge="_icon_sycip_1",Fe="_counterInput_sycip_41",N={iconBtn:Ee,icon:Ge,counterInput:Fe},Oe=({cookingTime:r,setCookingTime:o})=>{const c=()=>{o(t=>t+1)},p=()=>{o(t=>t>1?t-1:1)};return e.jsxs("div",{children:[e.jsx("label",{children:"Cooking Time"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx(W,{iconId:"icon-minus",width:"16",height:"16",type:"button",style:N.iconBtn,styleSVG:N.icon,onClick:p}),e.jsx("div",{children:e.jsxs("span",{style:{margin:"0 12px"},children:[r," min"]})}),e.jsx(W,{iconId:"icon-plus",type:"button",width:"16",height:"16",style:N.iconBtn,styleSVG:N.icon,onClick:c})]})]})},qe=({register:r,setValue:o,watch:c,ingredients:p,selectedIngredients:t,setSelectedIngredients:l,errors:s,categories:m,areas:S,cookingTime:C,setCookingTime:T,isIngredientsLoading:B,isCategoriesLoading:A,isAreasLoading:D})=>{var v;const[L,g]=y.useState(!1),u=c("ingredient"),j=c("measure"),f=()=>{if(u&&j){const a=p.find(h=>h._id===u.value);l([...t,{id:u.value,measure:j,imageUrl:a.img,label:u.label}]),o("ingredient",null),o("measure",""),g(!0)}},b=a=>{l(t.filter((h,k)=>k!==a)),t.length<=1&&g(!1)};return e.jsxs("div",{className:i.container,children:[e.jsxs("div",{className:i.textareaWrapper,children:[e.jsx("textarea",{...r("description"),maxLength:"200",placeholder:"Enter the description of the dish",className:i.textarea}),e.jsxs("span",{className:i.symbolCounter,children:[((v=c("description"))==null?void 0:v.length)||0,"/200"]}),s.description&&e.jsx("p",{children:s.description.message})]}),e.jsx("div",{className:i.categoryAndTime,children:A?e.jsx("p",{children:"Loading..."}):e.jsxs("div",{children:[e.jsx("label",{children:"Category"}),e.jsx(w,{options:m,placeholder:"Select a category",...r("category"),onChange:a=>o("category",a.label)}),s.category&&e.jsx("p",{children:s.category.message})]})}),e.jsx("div",{className:i.categoryAndTime,children:D?e.jsx("p",{children:"Loading..."}):e.jsxs("div",{children:[e.jsx("label",{children:"Area"}),e.jsx(w,{options:S,placeholder:"Select area",...r("area"),onChange:a=>o("area",a.label)}),s.category&&e.jsx("p",{children:s.category.message})]})}),e.jsxs("div",{children:[e.jsx(Oe,{cookingTime:C,setCookingTime:T}),s.cookingTime&&e.jsx("p",{children:s.cookingTime.message})]}),e.jsxs("div",{className:i.ingredientAndQuantity,children:[B?e.jsx("p",{children:"Loading..."}):e.jsxs("div",{children:[e.jsx("label",{children:"Ingredient"}),e.jsx(w,{options:p,placeholder:"Select an ingredient",className:i.select,...r("ingredient"),onChange:a=>o("ingredient",a)}),s.ingredient&&e.jsx("p",{children:s.ingredient.message})]}),e.jsxs("div",{children:[e.jsx(Q,{type:"text",name:"measure",register:r,placeholder:"Enter quantity",classname:i.inputQuantity}),s.measure&&e.jsx("p",{children:s.measure.message})]})]}),L&&e.jsx("ul",{className:i.list,children:t.map((a,h)=>e.jsxs("li",{className:i.listItem,children:[e.jsx("div",{className:i.imageWrapper,children:e.jsx("img",{src:a.imageUrl,alt:a.label,width:"55px",height:"55px",className:i.image})}),e.jsxs("div",{className:i.textWrapper,children:[e.jsx("p",{children:a.label}),e.jsx("p",{children:a.measure})]}),e.jsx(W,{iconId:"icon-close-btn",type:"button",onClick:()=>b(h),style:i.iconBtn})]},h))}),e.jsx($,{text:"Add ingredient +",type:"button",onClick:f,iconId:"icon-plus",classname:i.buttonAdd})]})},Je="_formTitleWrapper_1hnv8_1",Me="_fromDescription_1hnv8_37",He="_formTitle_1hnv8_1",R={formTitleWrapper:Je,fromDescription:Me,formTitle:He},Ke=()=>e.jsx("div",{className:R.formTitleWrapper,children:e.jsx("p",{className:R.fromDescription,children:"Reveal your culinary art, share your favorite recipe and create gastronomic masterpieces with us."})}),Ze=()=>{var U;const{register:r,handleSubmit:o,control:c,setValue:p,watch:t,formState:{errors:l},reset:s}=J({resolver:Y(te),defaultValues:{selectedIngredients:[]}}),{data:m,isLoading:S}=M(),{data:C,isLoading:T}=H(),{data:B,isLoading:A}=K(),{data:D}=V(),[L]=z(),[g,u]=y.useState([]),[j,f]=y.useState(null),[b,v]=y.useState(1),a=m,h=C,k=B,P=X(),E=async x=>{const d=new FormData;d.append("thumb",x.thumb[0]),d.append("title",x.title),d.append("description",x.description),d.append("category",x.category),d.append("area",x.area),d.append("time",b.toString()),d.append("instructions",x.instructions);const F=g.map(I=>({id:I.id,measure:I.measure}));d.append("ingredients",JSON.stringify(F));try{await L(d),P(`/user/${D.id}`)}catch(I){alert("Error: "+I.response.data.message)}},G=()=>{s(),f(null),u([])};return e.jsxs("div",{className:n.container,children:[e.jsx(Z,{currentPage:"Add Recipe"}),e.jsxs("div",{className:n.titleWrapper,children:[e.jsx(ee,{text:"add recipe"}),e.jsx(Ke,{})]}),e.jsx("form",{onSubmit:o(E),className:n.form,children:e.jsxs("div",{className:n.formWrapper,children:[e.jsx(We,{register:r,setValue:p,imagePreview:j,setImagePreview:f,watch:t,errors:l}),e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx(Q,{type:"text",name:"title",register:r,placeholder:"The name of the recipe",classname:n.nameInput}),l.title&&e.jsx("p",{children:l.title.message})]}),e.jsx("div",{className:n.recipeData,children:e.jsx("div",{className:n.categoryAndTime,children:e.jsx("div",{className:n.recipeData,children:e.jsx(qe,{control:c,register:r,setValue:p,watch:t,categories:a,areas:k,cookingTime:b,setCookingTime:v,ingredients:h,selectedIngredients:g,setSelectedIngredients:u,errors:l,isCategoriesLoading:S,isIngredientsLoading:T,isAreasLoading:A})})})}),e.jsxs("div",{className:n.recipeIncstructions,children:[e.jsx("label",{className:n.labelPrep,children:"Recipe preparation"}),e.jsxs("div",{className:n.textareaWrapper,children:[e.jsx("textarea",{...r("instructions"),placeholder:"Enter recipe",maxLength:"200",className:n.textarea}),e.jsxs("span",{className:n.symbolCounter,children:[((U=t("instructions"))==null?void 0:U.length)||0,"/200"]}),l.instructions&&e.jsx("p",{children:l.instructions.message})]})]}),e.jsxs("div",{className:n.buttonWrapper,children:[e.jsx(W,{iconId:"icon-trash",type:"button",onClick:G,width:"20",height:"20",style:n.trashBtn,styleSVG:n.iconTrash}),e.jsx($,{text:"Publish",type:"submit",classname:n.button})]})]})]})})]})};export{Ze as default};
